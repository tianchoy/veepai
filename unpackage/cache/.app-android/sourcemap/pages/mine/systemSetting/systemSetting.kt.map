{"version":3,"sources":["pages/mine/systemSetting/systemSetting.uvue","App.uvue"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<view class=\"content\">\n\t\t\t<view class=\"items underline\">\n\t\t\t\t<view class=\"offline\">\n\t\t\t\t\t<text>离线提醒</text>\n\t\t\t\t\t<fui-switch :checked= \"checked\" @change=\"changeChecked\" @update:checked=\"isChecked\"></fui-switch>\n\t\t\t\t</view>\n\t\t\t\t<text class=\"tips\">设备离线8小时后,推送消息到APP</text>\n\t\t\t</view>\n\t\t\t<view class=\"items\">\n\t\t\t\t<fui-input label=\"自动播放\" :labelSize=\"28\" textAlign=\"right\" :borderBottom=\"false\"\n\t\t\t\t\tplaceholderStyle=\"font-size: 28rpx;\" :disabled=\"true\" :placeholder = \"playTypeItem\" @click=\"playType\">\n\t\t\t\t\t<text>\n\t\t\t\t\t\t<fui-icon name=\"arrowright\" :size=\"48\"></fui-icon>\n\t\t\t\t\t</text>\n\t\t\t\t</fui-input>\n\t\t\t\t<text class=\"tips\">摄像机视频是否自动播放</text>\n\t\t\t</view>\n\t\t</view>\n\t\t<view class=\"content\">\n\t\t\t<view v-for=\"(item,index) in permissionList\" :key=\"index\">\n\t\t\t\t<fui-input :label=\"item.name\" :labelSize=\"28\" textAlign=\"right\" :borderBottom=\"true\"\n\t\t\t\t\t:placeholderStyle=\"item.status == '未授权' ? 'font-size: 28rpx;color:red;' : 'font-size: 28rpx;color:green;'\" :disabled=\"true\" :placeholder = \"item.status\" @click=\"getSystemAuth(item)\">\n\t\t\t\t\t<text>\n\t\t\t\t\t\t<fui-icon name=\"arrowright\" :size=\"48\"></fui-icon>\n\t\t\t\t\t</text>\n\t\t\t\t</fui-input>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<fui-bottom-popup :visible=\"showPicker\">\n\t\t\t<l-picker cancel-btn=\"取消\" confirm-btn=\"确定\" :columns=\"pickerOptions\" @cancel=\"oncancel\" @confirm=\"onConfirm\">\n\t\t\t</l-picker>\n\t\t</fui-bottom-popup>\n\t</view>\n</template>\n\n<script setup lang=\"uts\">\n\timport { ref } from 'vue'\n\timport { PickerColumn ,PickerConfirmEvent} from '@/uni_modules/lime-picker';\n\tconst checked = ref<boolean>(true)\n\tconst showPicker = ref<boolean>(false)\n\tconst pickerOptions = ref<PickerColumn[]>([])\n\tconst playTypeItem = ref<string>('WIFI下自动播放')\n\tconst systemNotifyState = ref<string>('')\n\n\t//授权类型\n\ttype AuthType = {\n\t\tcode:string\n\t\tstate: string\n\t}\n\n\tconst AuthState = ref<AuthType[]>([\n\t\t{\n\t\t\tcode:'authorized',\n\t\t\tstate: '已授权',\n\t\t},\n\t\t{\n\t\t\tcode:'not determined',\n\t\t\tstate: '未授权',\n\t\t},\n\t\t{\n\t\t\tcode:'denied',\n\t\t\tstate: '未授权',\n\t\t},\n\t])\n\n\t// 权限项类型\n\ttype PermissionItem = {\n\t\tname: string\n\t\tcode: string\n\t\tstatus: string\n\t}\n\n\t// 权限列表数据\n\tconst permissionList = ref<PermissionItem[]>([\n\t\t{ name: '位置信息', code: 'locationAuthorized', status: 'notDetermined' },\n\t\t{ name: '相册', code: 'albumAuthorized', status: 'notDetermined' },\n\t\t{ name: '麦克风', code: 'microphoneAuthorized', status: 'notDetermined' },\n\t\t{ name: '蓝牙', code: 'bluetoothAuthorized', status: 'notDetermined' },\n\t\t{ name: '系统通知', code: 'notificationAuthorized', status: 'notDetermined' },\n\t\t{ name: '相机', code: 'cameraAuthorized', status: 'notDetermined' },\n\t])\n\n\tconst getSystemAuth = (item:PermissionItem) => {\n\t\tconst res = uni.getAppAuthorizeSetting();\n\t\tconst code = item.code\n\t\tif(code == 'bluetoothAuthorized'){\n\t\t\tconst resu = uni.getSystemSetting();\n\t\t\tconsole.log(resu)\n\t\t\tif(resu.bluetoothEnabled == false){\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '请先手动打开蓝牙',\n\t\t\t\t})\n\t\t\t}else{\n\t\t\t\tpermissionList.value.map(item => {\n\t\t\t\t\tif(item.code == 'bluetoothAuthorized'){\n\t\t\t\t\t\titem.status = '已授权'\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}else{\n\t\t\tconst status = res[code]\n\t\t\tif(status == 'denied' || status == \"not determined\"){\n\t\t\t\tuni.openAppAuthorizeSetting({\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tconsole.log(res)\n\t\t\t\t\t\t// item.status = '已授权' \n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\n\n\tconst changeChecked = () => {\n\t\tconsole.log(checked.value)\n\t}\n\n\tconst isChecked = () => {\n\t\tchecked.value = !checked.value\n\t}\n\n\tconst getSystemNotify = () => {\n\t\tconst res = uni.getAppAuthorizeSetting();\n\t\tconsole.log(res.notificationAuthorized)\n\t\tif(res.notificationAuthorized == 'denied' || res.notificationAuthorized == \"not determined\"){\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '请先授权通知权限',\n\t\t\t})\n\t\t\tuni.openAppAuthorizeSetting({\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tconsole.log(res)\n\t\t\t\t\tsystemNotifyState.value = '已授权'\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tconst playType = () => {\n\t\tpickerOptions.value = [\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tlabel: 'WIFI下自动播放',\n\t\t\t\t\tvalue: 'WIFI下自动播放',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: '总是播放',\n\t\t\t\t\tvalue: '总是播放',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: '不播放',\n\t\t\t\t\tvalue: '不播放',\n\t\t\t\t}\n\t\t\t]\n\t\t]  as PickerColumn[]\n\t\tshowPicker.value = true\n\t}\n\n\tconst onConfirm = (context : PickerConfirmEvent) => {\n\t\tshowPicker.value = false\n\t\tplayTypeItem.value = context.values[0].toString()\n\t}\n\n\tconst oncancel = () => {\n\t\tshowPicker.value = false\n\t}\n\n\tonPageShow(() => {\n    const res = uni.getAppAuthorizeSetting();\n    const resu = uni.getSystemSetting();\n    \n    permissionList.value = permissionList.value.map(item => {\n        const newItem = {...item} as PermissionItem;\n        if (item.code == 'bluetoothAuthorized' && resu.bluetoothEnabled == true) {\n            newItem.status = '已授权';\n        } else {\n            AuthState.value.forEach((auth) => {\n                if (auth.code === res[item.code]) {\n                    newItem.status = auth.state;\n                }\n            });\n        }\n        \n        return newItem;\n    });\n})\n\n\t// onLoad(()=>{\n\t// \tconst res = uni.getAppAuthorizeSetting();\n\t// \tconsole.log(res)\n\t// })\n</script>\n\n<style lang=\"scss\" scoped>\n\t.container{\n\t\theight: 100%;\n\t\tbackground-color: #f5f5f5;\n\t\tpadding: 20rpx;\n\t\t.content{\n\t\t\tbackground-color: #fff;\n\t\t\tpadding: 20rpx;\n\t\t\tborder-radius: 20rpx;\n\t\t\tmargin-bottom: 20rpx;\n\t\t\t.items{\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: column;\n\t\t\t\tpadding: 20rpx;\n\t\t\t\t.fui-input__wrap{\n\t\t\t\t\tpadding: 20rpx 0 !important;\n\t\t\t\t}\n\t\t\t\t.offline{\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-direction: row;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: space-between;\n\t\t\t\t\tpadding-bottom: 10rpx;\n\t\t\t\t}\n\t\t\t\t.tips{\n\t\t\t\t\t\tcolor:#999;\n\t\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\t}\n\t\t\t}\n\t\t\t.underline{\n\t\t\t\tborder-bottom: 1rpx solid #f5f5f5;\n\t\t\t}\n\t\t}\n\t\t\n\t\t.l-picker{\n\t\t\twidth:100%\n\t\t}\n\t}\t\n</style>\n",null],"names":[],"mappings":"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"}