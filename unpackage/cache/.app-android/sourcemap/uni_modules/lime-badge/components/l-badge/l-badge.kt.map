{"version":3,"sources":["uni_modules/lime-badge/components/l-badge/l-badge.uvue"],"sourcesContent":["<template>\n\t<view class=\"l-badge__wrapper\" v-if=\"$slots['default'] != null\">\n\t\t<slot></slot>\n\t\t<text v-if=\"hasContent || dot\" class=\"l-badge\" ref=\"textRef\" :class=\"classes\" :style=\"[styles]\">\n\t\t\t<slot name=\"content\">{{renderContent}}</slot>\n\t\t</text>\n\n\t\t<text v-if=\"hasContent || dot\" class=\"l-badge l-badge--offscreen\" ref=\"offscreenRef\" :class=\"classes\" :style=\"[styles]\">\n\t\t\t<slot name=\"content\">{{renderContent}}</slot>\n\t\t</text>\n\n\t</view>\n\t<text v-else-if=\"hasContent || dot\" class=\"l-badge\" :class=\"classes\" :style=\"[styles]\">\n\t\t<slot name=\"content\">{{renderContent}}</slot>\n\t</text>\n</template>\n<script lang=\"uts\" setup>\n\t/**\n\t * Badge 徽标组件\n\t * @description 用于展示状态标记、消息数量等提示信息，支持多种形态和定位方式\n\t * <br> 插件类型：LBadgeComponentPublicInstance \n\t * @tutorial https://ext.dcloud.net.cn/plugin?name=lime-badge\n\t * \n\t * @property {string} [color] 徽标背景色（支持CSS颜色值）\n\t * @property {number | string | any} content 显示内容（数字/文字）\n\t * @property {boolean} dot 是否显示为小红点（优先级高于content）\n\t * @property {number} max 数字最大值（超出显示为${max}+）\n\t * @property {Array<string | number> | any[]} offset 位置偏移量（[x, y]）\n\t * @property {'top-right' | 'top-left' | 'bottom-right' | 'bottom-left'} position 定位位置\n\t * @property {'circle' | 'square' | 'bubble' | 'ribbon'} [shape] 形状（当前版本未实现）\n\t * @property {boolean} showZero 数值为0时是否显示\n\t * @property {'medium' | 'large'} [size] 尺寸（当前版本未实现）\n\t * @property {string | number} [content] 支持字符串模板（例：'${count}条'）\n\t * @property {Array<string | number>} offset 支持单位（例：['-10rpx', '20px']）\n\t */\n\t\n\timport { isNumeric } from '@/uni_modules/lime-shared/isNumeric'\n\timport { isNumber } from '@/uni_modules/lime-shared/isNumber'\n\timport { addUnit } from '@/uni_modules/lime-shared/addUnit'\n\timport { toBoolean } from '@/uni_modules/lime-shared/toBoolean'\n\timport { getOffsetWithMinusString } from './utils'\n\timport { BadgeProps } from './type'\n\tconst name = 'l-badge'\n\tconst props = withDefaults(defineProps<BadgeProps>(), {\n\t\tdot: false,\n\t\tmax: 99,\n\t\tshowZero: false,\n\n\t\toffset: [] as any[],\n\n\n\n\n\t\tposition: 'top-right'\n\t})\n\t\n\t\n\t\n\tconst context = getCurrentInstance()!\n\tconst classes = computed(():Map<string, boolean>=>{\n\t\tconst cls = new Map<string, boolean>()\n\t\tcls.set(`${name}--fixed`, toBoolean(context.slots['default']));\n\t\tcls.set(`${name}--dot`, props.dot);\n\t\tcls.set(`${name}--${props.position}`, context.slots['default'] != null);\n\t\treturn cls\n\t})\n\tconst styles = computed(():Map<string, any|null>=>{\n\t\tconst style = new Map<string, any|null>()\n\t\tif(toBoolean(props.color)) {\n\t\t\tstyle.set('background', props.color!)\n\t\t}\n\t\tconst positions = props.position.split('-');\n\t\tconst offset = props.offset;\n\t\tif(offset.length == 2) {\n\t\t\tconst x = offset[0];\n\t\t\tconst y = offset[1];\n\t\t\tif(context.slots['default'] != null) {\n\t\t\t\tif(positions.length == 2) {\n\t\t\t\t\tconst offsetY = positions[0], offsetX = positions[1];\n\t\t\t\t\tif(isNumber(y)) {\n\t\t\t\t\t\tconst _y = y as number\n\t\t\t\t\t\tstyle.set(offsetY, addUnit(offsetY == 'top' ? _y : -_y))\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstyle.set(offsetY, offsetY == 'top' ? addUnit(y) : getOffsetWithMinusString(`${y}`))\n\t\t\t\t\t}\n\t\t\t\t\tif(isNumber(x)) {\n\t\t\t\t\t\tconst _x = x as number\n\t\t\t\t\t\tstyle.set(offsetX, addUnit(offsetX == 'left' ? _x : -_x))\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstyle.set(offsetY, offsetY == 'left' ? addUnit(x) : getOffsetWithMinusString(`${x}`))\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstyle.set('margin-top', addUnit(y))\n\t\t\t\tstyle.set('margin-left', addUnit(x))\n\t\t\t}\n\t\t}\n\t\treturn style\n\t});\n\tconst hasContent = computed<boolean>(():boolean => {\n\t\tif(toBoolean(context.slots['content'])) {\n\t\t\treturn true\n\t\t}\n\t\tconst content = props.content;\n\t\treturn (content != '' && content != null && (props.showZero || content !== '0'));\n\t});\n\tconst renderContent = computed<string>(():string=>{\n\t\tconst dot = props.dot\n\t\tconst max = props.max\n\t\tconst content = props.content\n\t\tif(!dot && hasContent.value) {\n\t\t\tif(max != 0 && isNumeric(content) && parseFloat(content.toString()) > max) {\n\t\t\t\treturn `${max}+`\n\t\t\t}\n\t\t}\n\t\tif(dot) {\n\t\t\treturn ''\n\t\t}\n\t\treturn `${content ?? \"\"}`\n\t})\n\t\n\n\t// 安卓BUG 父级设置横向居中，子text定位absolute时宽度受限 https://issues.dcloud.net.cn/pages/issues/detail?id=11847\n\t// 暂时先绕一下\n\tconst textRef = ref<UniTextElement|null>(null)\n\tconst offscreenRef = ref<UniTextElement|null>(null)\n\tconst resizeObserver = new UniResizeObserver((entries : Array<UniResizeObserverEntry>) => {\n\t\tconst width = entries[0].target.getBoundingClientRect().width\n\t\ttextRef.value!.style.setProperty('width', width*1.05)\n\t}) \n\t\n\tconst stopWatch = watch(offscreenRef, (el:UniElement|null) => {\n\t\tif(el== null) return\n\t\tresizeObserver.observe(el)\n\t})\n\t\n\tonUnmounted(()=>{\n\t\tstopWatch()\n\t\tresizeObserver.disconnect()\n\t})\n\n\t\n</script>\n<style lang=\"scss\">\n\t@import './index-u';\n</style>"],"names":[],"mappings":"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"}