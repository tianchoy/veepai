{"version":3,"sources":["uni_modules/lime-icon/components/l-icon/l-icon.uvue"],"sourcesContent":["<template>\r\n\t<text class=\"l-icon\" :class=\"[classes, lClass]\" :style=\"[styles, lStyle]\" v-if=\"!isImage && !isIconify && !isSVG\" @click=\"$emit('click')\">{{iconCode}}</text>\r\n\t<image class=\"l-icon\" :class=\"[classes, lClass]\" :style=\"[styles, lStyle]\" v-else-if=\"(!isSVG && !isIconify) && isImage\" :src=\"iconUrl\" @click=\"$emit('click')\"></image>\r\n\t<!-- <l-svg class=\"l-icon\" :class=\"[classes, lClass]\" :style=\"[styles, lStyle]\" :color=\"color\" :src=\"iconUrl\" v-else :web=\"web\" @error=\"imageError\" @load=\"imageload\" @click=\"$emit('click')\"></l-svg> -->\r\n</template>\r\n<script lang=\"uts\" setup>\r\n\t/**\r\n\t * LimeIcon 图标\r\n\t * @description ICON集\r\n\t * <br> 插件类型：LIconComponentPublicInstance \r\n\t * @tutorial https://ext.dcloud.net.cn/plugin?id=14057\r\n\t * @property {String} name 图标名称\r\n\t * @property {String} color 颜色\r\n\t * @property {String} size 尺寸\r\n\t * @property {String} prefix 字体图标前缀  \r\n\t * @property {Boolean} inherit 是否继承颜色 \r\n\t * @property {Boolean} web 原生 app(nvue,uvue) 是否使用web渲染  \r\n\t * @event {Function} click 点击事件\r\n\t */\r\n\t\r\n\timport { addUnit } from '@/uni_modules/lime-shared/addUnit';\r\n\timport { IconCollection } from './types';\r\n\timport { icons } from './icons'\r\n\t// defineOptions({\r\n\t// \tname: 'l-icon'\r\n\t// })\r\n\tconst name = 'l-icon'\r\n\tconst IconifyURL : string = 'https://api.iconify.design/';\r\n\tconst $iconsHost : string | null = uni.getStorageSync('$limeIconsHost') as string | null\r\n\r\n\tconst props = defineProps({\r\n\t\tname: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '',\r\n\t\t\trequired: true,\r\n\t\t\t// validator: (value: string) : boolean => {\r\n\t\t\t// \t// 确保是字符串类型且不为空\r\n\t\t\t// \treturn typeof value == 'string' && value.trim().length > 0\r\n\t\t\t// }\r\n\t\t},\r\n\t\tcolor: {\r\n\t\t\ttype: String,\r\n\t\t\t// default: ''\r\n\t\t},\r\n\t\tsize: {\r\n\t\t\ttype: [String, Number],\r\n\r\n\r\n\r\n\t\t},\r\n\t\tprefix: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\tlClass: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\t// 对安卓IOS无效\r\n\t\tinherit: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\tweb: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\tlStyle: {\r\n\t\t\ttype: [String, Object, Array],\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t})\r\n\r\n\tconst emits = defineEmits(['click'])\r\n\tconst $iconCollection = inject<IconCollection>('$iconCollection', {has: false, icons: new Map<string, any|null>()} as IconCollection)\r\n\r\n\r\n\r\n\r\n\tconst innerName = computed(():string => props.name)\r\n\r\n\tconst collectionIcon = computed(():string|null => {\r\n\t\treturn $iconCollection.icons.get(innerName.value) as string | null\r\n\t})\r\n\tconst webviewRef = ref<UniWebViewElement | null>(null)\r\n\tconst hasHost = computed<boolean>(() : boolean => innerName.value.indexOf('/') != -1)\r\n\tconst isIconify = computed<boolean>(() : boolean => {\r\n\t\treturn !hasHost.value && innerName.value.includes(':')\r\n\t})\r\n\tconst isImage = computed<boolean>(() : boolean => {\r\n\t\treturn /\\.(jpe?g|png|gif|bmp|webp|tiff?)$/i.test(innerName.value) || /^data:image\\/(jpeg|png|gif|bmp|webp|tiff);base64,/.test(innerName.value)\r\n\t})\r\n\tconst isSVG = computed<boolean>(():boolean => {\r\n\t\treturn /\\.svg$/i.test(innerName.value) || innerName.value.startsWith('data:image/svg+xml') || innerName.value.startsWith('<svg')\r\n\t})\r\n\tconst classes = computed<Map<string, any>>(() : Map<string, any> => {\r\n\t\tconst cls = new Map<string, any>()\r\n\t\tcls.set(`${name}--font`, !isImage.value && !isIconify.value && !isSVG.value)\r\n\t\tcls.set(`${name}--image`, isImage.value || isIconify.value || isSVG.value)\r\n\t\tcls.set(props.prefix, props.prefix.length > 0)\r\n\t\tcls.set(props.lClass, props.lClass.length > 0)\r\n\r\n\r\n\r\n\t\treturn cls\r\n\t})\r\n\tconst styles = computed<Map<string, any>>(() : Map<string, any> => {\r\n\t\tconst style = new Map<string, any>();\r\n\r\n\t\tif ((props.color != '' && props.color != null) && !isImage.value && !isIconify.value) {\r\n\t\t\tstyle.set('color', props.color!)\r\n\t\t}\r\n\t\tconst size = addUnit(props.size) ?? ((isImage.value || isIconify.value) ? '32px' : null)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\tif (size != null) {\r\n\t\t\tif (isImage.value || isIconify.value || isSVG.value) {\r\n\t\t\t\tstyle.set('height', size)\r\n\t\t\t\tstyle.set('width', size)\r\n\t\t\t} else {\r\n\t\t\t\tstyle.set('font-size', size)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\treturn style\r\n\t})\r\n\tconst iconCode = computed<string>(() : string => {\r\n\t\treturn icons.value.get(innerName.value) as string | null ?? (/[^\\x00-\\x7F]/.test(innerName.value) ? innerName.value : '')\r\n\t})\r\n\tconst isError = ref(false)\r\n\tconst cacheMap = new Map<string, string>()\r\n\tconst iconUrl = computed(():string => {\r\n\t\tconst hasIconsHost = $iconsHost != null && $iconsHost != '' \r\n\t\t// const hasIconCollection = $iconCollection.has\r\n\t\tif(isImage.value) {\r\n\t\t\treturn hasHost.value ? innerName.value : ($iconsHost ?? '') + innerName.value\r\n\t\t} else if(isIconify.value) {\r\n\t\t\t// 防止重绘\r\n\t\t\tif(cacheMap.has(innerName.value) && !isError.value) {\r\n\t\t\t\treturn cacheMap.get(innerName.value)!\r\n\t\t\t}\r\n\t\t\t// 如果存在collectionIcon则使用 \r\n\t\t\t// 如果设置的路径加载失败 就使用网络地址 就使用iconify api\r\n\t\t\tconst _host = `${hasIconsHost ? $iconsHost : IconifyURL}`\r\n\t\t\tconst _icon =collectionIcon.value ?? _host + `${innerName.value}.svg`.replace(/:/g, '/') \r\n\t\t\tcacheMap.set(innerName.value, _icon)\r\n\t\t\treturn _icon\r\n\t\t} else if(isSVG.value) {\r\n\t\t\treturn (/\\.svg$/i.test(innerName.value) && $iconsHost != null && !hasHost.value ? $iconsHost : '') + innerName.value.replace(/'/g, '\"')\r\n\t\t} else {\r\n\t\t\treturn ''\r\n\t\t}\r\n\t})\r\n\t\t\r\n\tconst imageError = () => {\r\n\t\tisError.value = true\r\n\t}\r\n\tconst imageload = () => {\r\n\t\tisError.value = false\r\n\t}\r\n</script>\r\n<style lang=\"scss\">\r\n\t@import './index.scss';\r\n</style>"],"names":[],"mappings":"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"}