{"version":3,"sources":["uni_modules/lime-textarea/components/l-textarea/l-textarea.uvue"],"sourcesContent":["<template>\n\t<view \n\t\tclass=\"l-textarea\" \n\t\tref=\"textareaRef\"\n\t\t:style=\"[styles, lStyle]\"\n\t\t:class=\"[\n\t\t\t'l-textarea--' + layout,\n\t\t\t// classic ? 'l-textarea--classic-' + status : '',\n\t\t\t{\n\t\t\t\t'l-textarea--classic': classic,\n\t\t\t\t'l-textarea--classic-disabled':  classic && isDisabled,\n\t\t\t\t'l-textarea--classic-focused':  classic && !isDisabled && innerFocused,\n\t\t\t\t'l-textarea--border': bordered && !classic\n\t\t\t}]\">\n\t\t<text \n\t\t\tclass=\"l-textarea__label\" \n\t\t\t:style=\"[labelStyle]\"\n\t\t\t:class=\"[\n\t\t\t\t'l-textarea__label--' + layout,\n\t\t\t]\"\n\t\t\tv-if=\"label != null || $slots['label'] != null\">\n\t\t\t<slot>{{label}}</slot>\n\t\t</text>\n\t\t<view class=\"l-textarea__wrapper\">\n\n\t\t\t<textarea \n\t\t\t\tclass=\"l-textarea__wrapper-inner\"\n\t\t\t\t:style=\"[innerStyle]\"\n\t\t\t\t:class=\"{'is-disabled': isDisabled}\"\n\t\t\t\t:maxlength=\"maxlength\"\n\t\t\t\t:disabled=\"isDisabled || isReadonly\"\n\t\t\t\t:placeholder=\"placeholder\"\n\t\t\t\tplaceholder-class=\"l-textarea__placeholder\"\n\t\t\t\t:placeholder-style=\"placeholderStyle\"\n\t\t\t\t:value=\"innerValue\"\n\t\t\t\t:auto-height=\"autosize\"\n\t\t\t\t:auto-focus=\"autofocus\"\n\t\t\t\t:fixed=\"fixed\"\n\t\t\t\t:focus=\"focus\"\n\t\t\t\t:cursor=\"cursor\"\n\t\t\t\t:cursor-spacing=\"cursorSpacing\"\n\t\t\t\t:adjust-position=\"adjustPosition\"\n\t\t\t\t:confirm-type=\"confirmType\"\n\t\t\t\t:confirm-hold=\"confirmHold\"\n\t\t\t\t:disable-default-padding=\"disableDefaultPadding\"\n\t\t\t\t:show-confirm-bar=\"showConfirmBar\"\n\t\t\t\t:selection-start=\"selectionStart\"\n\t\t\t\t:selection-end=\"selectionEnd\"\n\t\t\t\t:hold-keyboard=\"holdKeyboard\"\n\t\t\t\t@input=\"onInput\"\n\t\t\t\t@focus=\"onFocus\"\n\t\t\t\t@blur=\"onBlur\"\n\t\t\t\t@confirm=\"onConfirm\"\n\t\t\t\t@linechange=\"onLineChange\"\n\t\t\t\t@keyboardheightchange=\"onKeyboardHeightChange\">\n\t\t\t</textarea>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t\t\t\n\t\t\t<text class=\"l-textarea__indicator\" :style=\"[indicatorStyle]\" v-if=\"indicator && ((maxcharacter ?? maxlength) > 0 )\">{{count}} / {{maxcharacter ?? maxlength}}</text>\n\t\t</view>\n\t</view>\n</template>\n<script lang=\"uts\" setup>\n\t/**\n\t * Textarea 多行输入框组件\n\t * @description 用于多行文本输入场景，支持自适应高度和多种键盘控制选项\n\t * <br>插件类型：LTextareaComponentPublicInstance \n\t * @tutorial https://ext.dcloud.net.cn/plugin?name=lime-textarea\n\t * \n\t * @property {boolean} adjustPosition 键盘弹起自动上推页面（默认：true）\n\t * @property {boolean} autofocus 自动聚焦（默认：false）\n\t * @property {boolean} autosize 自动调整高度（默认：false）\n\t * @property {boolean} bordered 显示外边框（默认：true）\n\t * @property {boolean} confirmHold 点击确认保持键盘不收起（默认：false）\n\t * @property {'return' | 'send' | 'search' | 'next' | 'go' | 'done'} confirmType 键盘确认按钮类型（默认：\"done\"）\n\t * @value return\n\t * @value send\n\t * @value search\n\t * @value next\n\t * @value go\n\t * @value done\n\t * @property {number} cursor 聚焦时初始光标位置\n\t * @property {number} cursorSpacing 键盘与输入框间距（单位px，默认：0）\n\t * @property {boolean} disableDefaultPadding 禁用iOS默认内边距（默认：false）\n\t * @property {boolean} disabled 禁用状态（默认：false）\n\t * @property {boolean} readonly 只读（默认：false）\n\t * @property {boolean} classic 经典边框（默认：false）\n\t * @property {boolean} fixed 在fixed定位区域使用（默认：false）\n\t * @property {boolean} defaultFixed 默认fixed模式（兼容旧版）\n\t * @property {boolean} focus 自动聚焦（默认：false）\n\t * @property {boolean} focused 是否显示获焦样式，用于结合自定义键盘使用时显示高亮效果\n\t * @property {boolean} holdKeyboard 点击页面不收起键盘（默认：false）\n\t * @property {boolean} indicator 显示字数统计（默认：false）\n\t * @property {string} label 左侧标签文本\n\t * @property {number} maxcharacter 最大字符长度（中文算2个）\n\t * @property {number} maxlength 最大输入长度（默认：-1不限制）\n\t * @property {string} placeholder 占位文字\n\t * @property {number} selectionEnd 光标结束位置（需搭配selectionStart）\n\t * @property {number} selectionStart 光标起始位置（需搭配selectionEnd）\n\t * @property {boolean} showConfirmBar 显示键盘完成栏（默认：true）\n\t * @property {string} value 输入值（支持v-model）\n\t * @property {'vertical' | 'horizontal'} layout 标签布局方式（默认：\"horizontal\"）\n\t * @value vertical\n\t * @value horizontal\n\t * @property {string} placeholderStyle 占位文字样式（仅支持color/font-size/font-weight）\n\t * @property {string} lStyle 自定义组件样式（CSS字符串）\n\t * @property {string} labelStyle 标签样式（CSS字符串）\n\t * @property {string} indicatorStyle 字数统计样式（CSS字符串）\n\t * @property {string} innerStyle 输入区域样式（CSS字符串）\n\t * @property {string} borderColor 边框颜色\n\t * @property {string} focusedBorderColor 聚焦时边框颜色\n\t * @event {Function} focus 聚焦时触发\n\t * @event {Function} blur 失焦时触发\n\t * @event {Function} confirm 点击完成按钮触发\n\t * @event {Function} linechange 行数变化时触发\n\t * @event {Function} change \n\t * @event {Function} keyboardheightchange \n\t */\n\n\n\timport { TextareaProps } from './type';\n\timport { characterLimit, type CharacterLengthResult } from '@/uni_modules/lime-shared/characterLimit';\n\t\n\n\timport { useDrawBorder, DrawBorderOptions } from '@/uni_modules/lime-style/hairline'\n\n\t\n\tconst emit = defineEmits(['change', 'focus', 'blur', 'confirm', 'linechange', 'keyboardheightchange'])\n\tconst props = withDefaults(defineProps<TextareaProps>(), {\n\t\tadjustPosition: true,\n\t\tautofocus: false,\n\t\tautosize: false,\n\t\tbordered: true,\n\t\tconfirmHold: false,\n\t\tconfirmType: 'return',\n\t\tcursor: -1,\n\t\tcursorSpacing: 0,\n\t\tdisableDefaultPadding: false,\n\t\tdisabled: false,\n\t\tfixed: false,\n\t\tdefaultFixed: false,\n\t\tfocus: false,\n\t\tholdKeyboard: false,\n\t\tindicator: false,\n\t\tmaxlength: -1,\n\t\tplaceholder: '',\n\t\tplaceholderStyle: '',\n\t\tselectionEnd:-1,\n\t\tselectionStart:-1,\n\t\tshowConfirmBar: true,\n\t\tlayout: 'horizontal',\n\t\tclassic: false,\n\t\treadonly: false,\n\t\tfocused: false\n\t})\n\t\n\tconst formItemBlur = inject<(() => void)|null>('formItemBlur', null);\n\tconst formDisabled = inject<Ref<boolean|null>|null>('formDisabled', null)\n\tconst formReadonly = inject<Ref<boolean|null>|null>('formReadonly', null)\n\t\n\tconst count = ref(0);\n\tconst innerFocused = ref(props.focus || props.focused);\n\t\n\tconst calculateValue = (value: string):CharacterLengthResult => {\n\t\tconst { maxlength, maxcharacter } = props;\n\t\tif(maxcharacter != null && maxcharacter > 0) {\n\t\t\treturn characterLimit('maxcharacter', value, maxcharacter)\n\t\t} else if(maxlength > 0) {\n\t\t\treturn characterLimit('maxlength', value, maxlength)\n\t\t}\n\t\treturn {\n\t\t\tcharacters: value,\n\t\t\tlength: value.length\n\t\t} as CharacterLengthResult\n\t}\n\tlet _innerValue = ''\n\tconst modelValue = defineModel({type: String, default: ''})\n\tconst innerValue = computed({\n\t\tset(v: string) {\n\t\t\t_innerValue = v;\n\t\t\tmodelValue.value = v;\n\t\t\temit('change', v)\n\t\t},\n\t\tget():string {\n\t\t\tconst _value = props.value ?? modelValue.value\n\t\t\tif(_innerValue != _value) {\n\t\t\t\tconst {characters, length} = calculateValue(props.value ?? modelValue.value);\n\t\t\t\tcount.value = length;\n\t\t\t\treturn characters\n\t\t\t}\n\t\t\treturn _value\n\t\t},\n\t} as WritableComputedOptions<string>)\n\t\n\tconst isReadonly= computed(():boolean=>{\n\t\tif (props.readonly) return props.readonly;\n\t\treturn formReadonly?.value ?? false;\n\t})\n\tconst isDisabled= computed(():boolean=>{\n\t\tif (props.disabled) return props.disabled;\n\t\treturn formDisabled?.value ?? false;\n\t})\n\t\n\t\n\tconst styles = computed(():Map<string, string>=> {\n\t\tconst style = new Map<string, string>()\n\n\n\n\n\n\n\n\n\t\treturn style\n\t})\n\t\n\tconst onInput = (event: UniInputEvent) => {\n\t\tlet { value, cursor } = event.detail;\n\t\tconst {characters, length} = calculateValue(value);\n\t\tcount.value = length;\n\t\tinnerValue.value = characters;\n\t}\n\tconst onFocus = (event: UniTextareaFocusEvent) => {\n\t\tinnerFocused.value = true;\n\t\temit('focus', event)\n\t}\n\tconst onBlur = (event: UniTextareaBlurEvent) => {\n\t\tinnerFocused.value = false;\n\t\temit('blur', event)\n\t\tformItemBlur?.()\n\t}\n\tconst onConfirm = (event: UniInputConfirmEvent) => {\n\t\temit('confirm', event)\n\t}\n\tconst onLineChange = (event: UniTextareaLineChangeEvent) => {\n\t\temit('linechange', event)\n\t}\n\tconst onKeyboardHeightChange = (event: UniInputKeyboardHeightChangeEvent) => {\n\t\temit('keyboardheightchange', event)\n\t}\n\t\n\twatchEffect(()=> {\n\t\tinnerFocused.value = props.focus || props.focused;\n\t})\n\t\n\t\n\n\tconst textareaRef = ref<UniElement|null>(null);\n\tconst { clearBorder, color, renderBorder } = useDrawBorder(textareaRef, \n\t\t{  \n\t\t\tdirection: 'bottom',\n\t\t\twatchSize: true,\n\t\t\tstartOffset: 16,\n\t\t\timmediate: false,\n\t\t\tcolor: props.borderColor \n\t\t} as DrawBorderOptions)\n\t\t\n\tonMounted(()=>{\n\t\twatchEffect(()=>{\n\t\t\t\n\t\t\tif(!props.classic) {\n\t\t\t\tif(props.borderColor != null && !innerFocused.value) {\n\t\t\t\t\ttextareaRef.value?.style.setProperty('border-color', props.borderColor)\n\t\t\t\t}\n\t\t\t\tif(props.focusedBorderColor != null && innerFocused.value) {\n\t\t\t\t\ttextareaRef.value?.style.setProperty('border-color', props.focusedBorderColor)\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\tif(!props.bordered || props.classic) {\n\t\t\t\tclearBorder()\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif(props.borderColor != null && !innerFocused.value) {\n\t\t\t\tcolor.value = props.borderColor!\n\t\t\t}\n\t\t\trenderBorder()\n\t\t})\n\t})\n\n\t\n</script>\n<style lang=\"scss\">\n\t@import './index';\n</style>\n"],"names":[],"mappings":"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"}