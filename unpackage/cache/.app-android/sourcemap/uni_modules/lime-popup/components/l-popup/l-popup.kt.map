{"version":3,"sources":["uni_modules/lime-popup/components/l-popup/l-popup.uvue"],"sourcesContent":["<template>\r\n\t<l-overlay\r\n\t\t:visible=\"innerValue\" \r\n\t\t:zIndex=\"overlayZIndex\"\r\n\t\t:appear=\"true\"\r\n\t\t:preventScrollThrough=\"preventScrollThrough\"\r\n\t\t:l-style=\"overlayStyle\"\r\n\t\t@click=\"handleOverlayClick\"\r\n\t\tv-if=\"destroyOnClose ? display && overlay : overlay\">\r\n\t</l-overlay>\r\n\t<view class=\"l-popup\" \r\n\t\tref=\"popupRef\"\r\n\t\tv-if=\"destroyOnClose ? display : inited\"\r\n\t\t:class=\"rootClass\" \r\n\t\t:style=\"[styles, lStyle]\"\r\n\t\t@transitionend=\"finished\">\r\n\t\t<slot></slot>\r\n\t\t<view class=\"l-popup__close\" v-if=\"closeable\" @click=\"handleClose\">\r\n\t\t\t<slot name=\"close-btn\">\r\n\t\t\t\t<l-icon class=\"l-popup__close-icon\" :name=\"closeIcon\" size=\"27px\" :color=\"iconColor\" />\r\n\t\t\t</slot>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n<script lang=\"uts\" setup>\r\n\t/**\r\n\t * Popup 弹出层组件\r\n\t * @description 提供多种位置的弹窗展示能力，支持自定义内容和动画效果\r\n\t * <br>插件类型：LPopupComponentPublicInstance \r\n\t * @tutorial https://ext.dcloud.net.cn/plugin?name=lime-popup\r\n\t * \r\n\t * @property {boolean} closeable 显示关闭按钮（默认：false）\r\n\t * @property {boolean} closeOnClickOverlay 点击遮罩关闭（默认：true）\r\n\t * @property {boolean} destroyOnClose 关闭时销毁内容（默认：false）\r\n\t * @property {string} overlayStyle 遮罩层样式（支持CSS字符串）\r\n\t * @property {'top' | 'left' | 'right' | 'bottom' | 'center' | ''} position 弹出位置\r\n\t * @value top    从顶部滑入\r\n\t * @value bottom 从底部滑入\r\n\t * @value left   从左侧滑入  \r\n\t * @value right  从右侧滑入\r\n\t * @value center 居中显示（默认）\r\n\t * @property {boolean} preventScrollThrough 阻止滚动穿透（默认：true）\r\n\t * @property {boolean} overlay 显示遮罩层（默认：true）\r\n\t * @property {string} transitionName 自定义动画名称（配合transition使用）\r\n\t * @property {string|number|Array} radius 圆角 可以是字符，数值，数组\r\n\t * @property {boolean} visible 控制显示/隐藏（支持v-model）\r\n\t * @property {number} zIndex 组件层级（默认：999）\r\n\t * @property {number} duration 动画时长（单位ms，默认：300）\r\n\t * @property {string} bgColor 内容区域背景色（默认：#ffffff）\r\n\t * @property {string} closeIcon 关闭图标名称/路径（默认：'close'）\r\n\t * @property {string} iconColor 关闭图标颜色（默认：#333）\r\n\t * @property {string} lStyle 自定义内容区样式（支持CSS字符串）\r\n\t * @property {boolean} safeAreaInsetBottom 适配底部安全区域（默认：true）\r\n\t * @property {boolean} safeAreaInsetTop 适配顶部安全区域（默认：true）\r\n\t * @event {Function} close 关闭时触发（返回触发来源：'close-btn' | 'overlay'）\r\n\t * @event {Function} change 切换时触发\r\n\t * @event {Function} click-overlay 点击遮罩触发\r\n\t * @event {Function} click-close 点击关闭触发\r\n\t * @event {Function} open 打开触发\r\n\t * @event {Function} opened 打开完成触发\r\n\t * @event {Function} closed 关闭完成触发\r\n\t * @event {Function} before-enter\r\n\t * @event {Function} enter \r\n\t * @event {Function} after-enter\r\n\t * @event {Function} before-leave\r\n\t * @event {Function} leave\r\n\t * @event {Function} after-leave\r\n\t */\r\n\timport { useTransition, UseTransitionOptions, TransitionEmitStatus } from '@/uni_modules/lime-transition';\r\n\timport { convertRadius } from './utils'\r\n\timport { PopupProps } from './type';\r\n\t\r\n\tconst emit = defineEmits(['change', 'click-overlay', 'click-close', 'open', 'opened','close','closed', 'before-enter', 'enter', 'after-enter', 'before-leave', 'leave', 'after-leave'])\r\n\tconst props = withDefaults(defineProps<PopupProps>(),{\r\n\t\tcloseable: false,\r\n\t\toverlay: true,\r\n\t\tcloseOnClickOverlay: true,\r\n\t\tpreventScrollThrough: true,\r\n\t\tdestroyOnClose: false,\r\n\t\tsafeAreaInsetBottom: true,\r\n\t\tsafeAreaInsetTop: false,\r\n\t\tposition: 'center',\r\n\t\tzIndex: 999,\r\n\t\tduration: 300,\r\n\t\tcloseIcon: 'close'\r\n\t})\r\n\t\r\n\tconst modelValue = defineModel({type: Boolean});\r\n\tconst innerValue = computed({\r\n\t\tset(value: boolean) {\r\n\t\t\tmodelValue.value = value;\r\n\t\t\temit('change', value)\r\n\t\t},\r\n\t\tget():boolean {\r\n\r\n\t\t\treturn (props.visible ?? false) || modelValue.value// ?? false\r\n\r\n\r\n\r\n\r\n\t\t}\r\n\t} as WritableComputedOptions<boolean>)\r\n\tconst status = ref<TransitionEmitStatus>('before-enter')\r\n\tconst {inited, display, classes, finished} = useTransition({\r\n\t\tdefaultName: props.transitionName ?? 'popup-fade',\r\n\t\tappear: innerValue.value,\r\n\t\temits: (name:TransitionEmitStatus) => { \r\n\t\t\tstatus.value = name\r\n\t\t\tif(name == 'before-enter') {\r\n\t\t\t\temit('open')\r\n\t\t\t} else if(name == 'after-enter') {\r\n\t\t\t\temit('opened')\r\n\t\t\t} else if(name == 'before-leave') {\r\n\t\t\t\temit('close')\r\n\t\t\t} else if(name == 'after-leave') {\r\n\t\t\t\temit('closed')\r\n\t\t\t}\r\n\t\t\temit(name) \r\n\t\t},\r\n\t\tvisible: (): boolean => innerValue.value,\r\n\t\tduration: props.duration,\r\n\t} as UseTransitionOptions)\r\n\t\r\n\tconst overlayZIndex = computed(():number => props.zIndex > 0 ? props.zIndex - 1: 998);\r\n\t\r\n\tconst rootClass = computed(():string=>{\r\n\t\tconst safe = props.safeAreaInsetTop && props.position == 'top' \r\n\t\t\t?  'l-popup--safe-top' \r\n\t\t\t:  props.safeAreaInsetBottom && props.position == 'bottom' \r\n\t\t\t\t? 'l-popup--safe-bottom'\r\n\t\t\t\t: ''\r\n\t\t\t\r\n\t\treturn `l-popup--${props.position} ${safe} ${classes.value}`\r\n\t})\r\n\t\r\n\tconst {safeAreaInsets} = uni.getWindowInfo()\r\n\t\r\n\tconst styles = computed<Map<string,any>>(():Map<string,any> => {\r\n\t\tconst style = new Map<string,any>();\r\n\r\n\t\tstyle.set('transition-duration', (['after-leave', 'before-enter'].includes(status.value) ? 0 : props.duration) + 'ms')\r\n\r\n\r\n\r\n\r\n\t\tif (props.bgColor != null) {\r\n\t\t\tstyle.set(\"background\", props.bgColor!)\r\n\t\t}\r\n\t\tif (props.zIndex > 0) {\r\n\t\t\tstyle.set(\"z-index\", props.zIndex)\r\n\t\t}\r\n\t\t\r\n\t\tif(props.safeAreaInsetBottom && props.position == 'bottom') {\r\n\t\t\tstyle.set('padding-bottom', safeAreaInsets.bottom + 'px')\r\n\t\t}\r\n\t\tif(props.safeAreaInsetTop && props.position == 'top') {\r\n\t\t\tstyle.set('padding-top', safeAreaInsets.top + 'px')\r\n\t\t}\r\n\t\t\r\n\t\tif(props.radius != null) {\r\n\t\t\tconst values = convertRadius(props.radius!)\r\n\t\t\tstyle.set('border-top-left-radius', values[0])\r\n\t\t\tstyle.set('border-top-right-radius', values[1])\r\n\t\t\tstyle.set('border-bottom-right-radius', values[2])\r\n\t\t\tstyle.set('border-bottom-left-radius', values[3])\r\n\t\t}\r\n\t\t\r\n\r\n\r\n\r\n\r\n\r\n\t\t\r\n\t\treturn style\r\n\t})\r\n\tconst handleOverlayClick = () => {\r\n\t\tif(props.closeOnClickOverlay) {\r\n\t\t\tinnerValue.value = false;\r\n\t\t\temit('click-overlay')\r\n\t\t}\r\n\t}\r\n\tconst handleClose = () => {\r\n\t\tinnerValue.value = false;\r\n\t\temit('click-close')\r\n\t}\r\n\t\r\n\r\n\tconst popupRef = ref<UniElement|null>(null)\r\n\t\r\n\twatchEffect(()=>{\r\n\t\tif(!display.value) {\r\n\t\t\tpopupRef.value?.style.setProperty('display', 'none')\r\n\t\t} else {\r\n\t\t\tpopupRef.value?.style.setProperty('display', 'flex')\r\n\t\t}\r\n\t})\r\n\r\n</script>\r\n<style lang=\"scss\">\r\n\t@import \"./index-u\";\r\n</style>"],"names":[],"mappings":";;;;;;;;;;;;;+BAuI8B;;;;;;;;;;;;;;;;;;;;;;;;;;;;YA/D7B,IAAA,KAAA,OAAA,MAAA,EAAA,OAAA,yBAAA,GAAA,CAAA,EAAA;gBAAA,MAAA,IAAA,CAAA,QAAA;YAAA;YACA,IAAM,QAAQ;YAcd,IAAM,aAAa,SAAA,SAAA,MAAA,KAAA,EAAA;YACnB,IAAM,aAAa,iCAClB,MAAA,IAAI,OAAO,OAAO,EAAA;gBACjB,WAAW,KAAK,GAAG;gBACnB,KAAK,UAAU;YAChB;cACA,MAAA,OAAM,OAAO,CAAA;gBAEZ,OAAO,CAAC,MAAM,OAAO,IAAI,KAAK,KAAK,WAAW,KAAK;YAKpD;;YAED,IAAM,SAAS,0BAA0B;YACzC,IAA6C,iBAAA,qCAC5C,cAAa,MAAM,cAAc,IAAI,cACrC,SAAQ,WAAW,KAAK,EACxB,QAAO,IAAC,2BAA6B;gBACpC,OAAO,KAAK,GAAG;gBACf,IAAG,QAAQ,gBAAgB;oBAC1B,KAAK;uBACC,IAAG,QAAQ,eAAe;oBAChC,KAAK;uBACC,IAAG,QAAQ,gBAAgB;oBACjC,KAAK;uBACC,IAAG,QAAQ,eAAe;oBAChC,KAAK;;gBAEN,KAAK;YACN;cACA,UAAS,OAAI,OAAO;uBAAI,WAAW,KAAK;;cACxC,WAAU,MAAM,QAAQ;gBAjBlB,SAAsC,eAAtC;gBAAQ,UAA8B,eAA9B;gBAAS,UAAqB,eAArB;gBAAS,WAAY,eAAZ;YAoBjC,IAAM,gBAAgB,SAAS,OAAG,MAAM;uBAAI,IAAA,MAAM,MAAM,GAAG,CAAC;oBAAG,MAAM,MAAM,GAAG,CAAC;;AAAE,uBAAG;;;;YAEpF,IAAM,YAAY,SAAS,OAAG,MAAM,CAAE;gBACrC,IAAM,OAAO,IAAA,MAAM,gBAAgB,IAAI,MAAM,QAAQ,IAAI;oBACrD;;oBACA,IAAA,MAAM,mBAAmB,IAAI,MAAM,QAAQ,IAAI;wBAC/C;;wBACA;;;gBAEJ,OAAO,cAAY,MAAM,QAAQ,GAAA,MAAI,OAAI,MAAI,QAAQ,KAAK;YAC3D;;YAEA,IAAM,AAAC,iBAAkB,oBAAlB;YAEP,IAAM,SAAS,SAAS,IAAI,MAAM,EAAC,GAAG,GAAG,OAAG,IAAI,MAAM,EAAC,GAAG,EAAI;gBAC7D,IAAM,QAAQ,AAAI,IAAI,MAAM,EAAC,GAAG;gBAEhC,MAAM,GAAG,CAAC,uBAAuB,AAAC,CAAA,IAAA;oBAAC;oBAAe;iBAAe,CAAC,QAAQ,CAAC,OAAO,KAAK;AAAI,qBAAC;;oBAAG,MAAM,QAAQ;;gBAAR,IAAY;gBAKjH,IAAI,MAAM,OAAO,IAAI,IAAI,EAAE;oBAC1B,MAAM,GAAG,CAAC,cAAc,MAAM,OAAO;;gBAEtC,IAAI,MAAM,MAAM,GAAG,CAAC,EAAE;oBACrB,MAAM,GAAG,CAAC,WAAW,MAAM,MAAM;;gBAGlC,IAAG,MAAM,mBAAmB,IAAI,MAAM,QAAQ,IAAI,UAAU;oBAC3D,MAAM,GAAG,CAAC,kBAAkB,eAAe,MAAM,GAAG;;gBAErD,IAAG,MAAM,gBAAgB,IAAI,MAAM,QAAQ,IAAI,OAAO;oBACrD,MAAM,GAAG,CAAC,eAAe,eAAe,GAAG,GAAG;;gBAG/C,IAAG,MAAM,MAAM,IAAI,IAAI,EAAE;oBACxB,IAAM,SAAS,cAAc,MAAM,MAAM;oBACzC,MAAM,GAAG,CAAC,0BAA0B,MAAM,CAAC,CAAC,CAAC;oBAC7C,MAAM,GAAG,CAAC,2BAA2B,MAAM,CAAC,CAAC,CAAC;oBAC9C,MAAM,GAAG,CAAC,8BAA8B,MAAM,CAAC,CAAC,CAAC;oBACjD,MAAM,GAAG,CAAC,6BAA6B,MAAM,CAAC,CAAC,CAAC;;gBASjD,OAAO;YACR;;YACA,IAAM,qBAAqB,KAAK;gBAC/B,IAAG,MAAM,mBAAmB,EAAE;oBAC7B,WAAW,KAAK,GAAG,KAAK;oBACxB,KAAK;;YAEP;YACA,IAAM,cAAc,KAAK;gBACxB,WAAW,KAAK,GAAG,KAAK;gBACxB,KAAK;YACN;YAGA,IAAM,WAAW,IAAI,aAAiB,IAAI;YAE1C,YAAY,KAAI;gBACf,IAAG,CAAC,QAAQ,KAAK,EAAE;oBAClB,SAAS,KAAK,EAAE,OAAM,YAAY,WAAW;uBACvC;oBACN,SAAS,KAAK,EAAE,OAAM,YAAY,WAAW;;YAE/C;;;;;;+BA3LO,IAAA,KAAA,cAAc;wBAAG,MAAA,YAAW,KAAA,OAAO;;wBAAG,KAAA,OAAO;;oBAAA;wBAPpD,IAQY,sBAAA,gBAPV,aAAS,MAAA,aACT,YAAQ,MAAA,gBACR,YAAQ,IAAI,EACZ,0BAAsB,KAAA,oBAAoB,EAC1C,aAAS,KAAA,YAAY,EACrB,aAAO;;;;;;;;;;+BAKF,IAAA,KAAA,cAAc;wBAAG,MAAA;;wBAAU,MAAA;;oBAAM;wBAFxC,IAYO,QAAA,gBAZD,WAAK,IAAA;4BAAC;4BAGH,MAAA;yBAAS,gBAFb,YAAJ,SAAI,UAGH,WAAK,IAAA;4BAAG,MAAA;4BAAQ,KAAA,MAAM;yBAAA,GACtB,qBAAe,MAAA;4BAChB,WAAa,KAAA,QAAA,EAAA;uCACsB,KAAA,SAAS;gCAA5C,IAIO,QAAA,gBAJD,WAAM,kBAAmC,aAAO;oCACrD,WAEO,KAAA,QAAA,EAAA,aAAA,eAAA,EAFP,gBAEO,GAAA;+CAAA;4CADN,IAAuF,mBAAA,IAA/E,WAAM,uBAAuB,UAAM,KAAA,SAAS,EAAE,UAAK,QAAQ,WAAO,KAAA,SAAS"}