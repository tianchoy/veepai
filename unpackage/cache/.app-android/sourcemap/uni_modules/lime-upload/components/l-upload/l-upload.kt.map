{"version":3,"sources":["uni_modules/lime-upload/components/l-upload/l-upload.uvue","uni_modules/lime-progress/utssdk/app-android/index.uts"],"sourcesContent":["<template>\r\n\t<view class=\"l-upload\" ref=\"uploadRef\" :style=\"styles\">\r\n\t\t<view class=\"l-upload__item\" v-for=\"(file, index) in customFiles\" :style=\"[itemStyle]\" :key=\"file.url\">\r\n\r\n\r\n\r\n\t\t\t\t<slot name=\"file\" :file=\"file\" :index=\"index\">\r\n\t\t\t\t\t<image class=\"l-upload__image\" v-if=\"file.type == 'image'\" :src=\"file.url\" :data-file=\"file\"\r\n\t\t\t\t\t\t:mode=\"imageFit\" @click=\"onProofTap(index)\" />\r\n\t\t\t\t\t<video class=\"l-upload__image\" v-if=\"file.type == 'video'\" :src=\"file.url\" :data-file=\"file\"\r\n\t\t\t\t\t\t:autoplay=\"false\" objectFit=\"contain\" @click=\"onFileClick(index)\" />\r\n\t\t\t\t\t<view class=\"l-upload__progress-mask\" v-if=\"file.status != null && file.status != 'done'\"\r\n\t\t\t\t\t\t:data-file=\"file\" @click=\"onFileClick(index)\">\r\n\t\t\t\t\t\t<template v-if=\"file.status == 'loading'\">\r\n\t\t\t\t\t\t\t<l-loading class=\"l-upload__progress-loading\" size=\"24px\" color=\"white\" />\r\n\t\t\t\t\t\t\t<text class=\"l-upload__progress-text\" v-if=\"file.percent != null\">{{file.percent}}%</text>\r\n\t\t\t\t\t\t\t<text class=\"l-upload__progress-text\" v-else>{{loadingText}}</text>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<l-icon v-else class=\"l-upload__progress-icon\"\r\n\t\t\t\t\t\t\t:name=\"file.status == 'reload' ? 'refresh' : 'close-circle'\" size=\"48rpx\" aria-hidden />\r\n\t\t\t\t\t\t<text v-if=\"file.status == 'reload' || file.status == 'failed'\" class=\"l-upload__progress-text\">\r\n\t\t\t\t\t\t\t{{file.status == 'reload' ? reloadText : failedText}}\r\n\t\t\t\t\t\t</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view v-if=\"!isReadonly\" class=\"l-upload__delete-btn\" aria-role=\"button\" aria-label=\"删除\" :data-index=\"index\"\r\n\t\t\t\t\t\t@click=\"onDelete(index)\">\r\n\t\t\t\t\t\t<l-icon name=\"close\" size=\"16px\" color=\"#fff\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</slot>\r\n\r\n\r\n\r\n\t\t</view>\r\n\r\n\t\t<view class=\"l-upload__item l-upload__item--add\" :class=\"{'l-upload__item--disabled':isDisabled}\"\r\n\t\t\tv-if=\"!isReadonly\"\r\n\t\t\tv-show=\"!multiple ? customFiles.length == 0 : max == 0 || customFiles.length != max\"\r\n\t\t\t:style=\"[itemStyle,  addBgColor!=null ? {background: addBgColor}: '']\" aria-label=\"上传\" @click=\"onAddTap\">\r\n\t\t\t<slot>\r\n\t\t\t\t<l-icon class=\"l-upload__add-icon\" :size=\"uploadIconSize\" :name=\"uploadIcon\" />\r\n\t\t\t</slot>\r\n\t\t</view>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t</view>\r\n</template>\r\n<script lang=\"uts\" setup>\r\n\t/**\r\n\t * Upload 文件上传组件\r\n\t * @description 用于图片、视频等文件的上传，支持预览、删除、重传等功能\r\n\t * <br>插件类型：LUploadComponentPublicInstance \r\n\t * @tutorial https://ext.dcloud.net.cn/plugin?name=lime-upload\r\n\t * \r\n\t * @property {string} name 表单字段名\r\n\t * @property {UTSJSONObject[]} modelValue 已上传文件列表（支持v-model）\r\n\t * @property {boolean} disabled 是否禁用（默认：false）\r\n\t * @property {boolean} readonly 只读（默认：false）\r\n\t * @property {boolean} multiple 是否支持多选（默认：false）\r\n\t * @property {'scaleToFill'|'aspectFit'|'aspectFill'|'widthFix'|'heightFix'|'top'|'bottom'|'center'|'left'|'right'|'top left'|'top right'|'bottom left'|'bottom right'} imageFit 图片裁剪模式（默认：\"aspectFill\"）\r\n\t * @value scaleToFill\r\n\t * @value aspectFit\r\n\t * @value aspectFill\r\n\t * @value widthFix\r\n\t * @value heightFix\r\n\t * @value top\r\n\t * @value bottom\r\n\t * @value 'top left'\r\n\t * @value 'top right'\r\n\t * @value 'bottom left'\r\n\t * @value \"bottom right\"\r\n\t * @property {string} gutter 项目间距（支持CSS单位）\r\n\t * @property {number} column 每行显示数量（默认：4）\r\n\t * @property {number} max 最大上传数量（默认：9）\r\n\t * @property {number} sizeLimit 文件大小限制（单位KB）\r\n\t * @property {string} uploadIcon 上传按钮图标\r\n\t * @property {string} uploadIconSize 上传按钮图标尺寸\r\n\t * @property {string} gridWidth 项目宽度（支持CSS单位）\r\n\t * @property {string} gridHeight 项目高度（支持CSS单位）\r\n\t * @property {string} gridBgColor 项目背景色\r\n\t * @property {string} addBgColor 添加按钮背景色\r\n\t * @property {string} gridBorderRadius 项目圆角\r\n\t * @property {UTSJSONObject[]} defaultFiles 默认文件列表\r\n\t * @property {string} loadingText 上传中提示文字\r\n\t * @property {string} reloadText 重传提示文字\r\n\t * @property {string} failedText 失败提示文字\r\n\t * @property {boolean} disablePreview 禁用预览（默认：false）\r\n\t * @property {boolean} autoUpload 自动上传（默认：true）\r\n\t * @property {'image' | 'video' | 'all' | 'media'} mediaType 上传文件类型（默认：\"image\"）\r\n\t * @value image\r\n\t * @value video\r\n\t * @value media\r\n\t * @value all\r\n\t * @property {number} maxDuration 视频最大时长（秒）\r\n\t * @property {string[]} sizeType 文件尺寸类型（默认：[\"original\", \"compressed\"]）\r\n\t * @property {string[]} sourceType 文件来源（默认：[\"album\", \"camera\"]）\r\n\t * @property {string} action 上传地址（uniCloud服务请设置为\"uniCloud\"）\r\n\t * @property {UTSJSONObject} headers 请求头部\r\n\t * @property {UTSJSONObject} formData 额外表单数据\r\n\t * @property {string} mode 显示模式（默认：\"grid\"）\r\n\t * @event {Function} add 点击增加时触发\r\n\t * @event {Function} success 上传成功时触发\r\n\t * @event {Function} fail 上传失败时触发\r\n\t * @event {Function} remove 点击删除时触发\r\n\t * @event {Function} click 点击时触发\r\n\t */\r\n\r\n\timport { unitConvert } from '@/uni_modules/lime-shared/unitConvert'\r\n\timport { chooseFiles } from './utils'\r\n\timport { UploadProps, UploadFile, ChooseFileOptions } from './type';\r\n\r\n\tdefineSlots<{\r\n\t\tfile(props : { file : UploadFile, index : number }) : any,\r\n\t}>()\r\n\r\n\tconst formDisabled = inject<Ref<boolean | null> | null>('formDisabled', null)\r\n\tconst formReadonly = inject<Ref<boolean | null> | null>('formReadonly', null)\r\n\r\n\tconst emits = defineEmits(['fail', 'remove', 'success', 'click', 'add', 'update:modelValue'])\r\n\tconst props = withDefaults(defineProps<UploadProps>(), {\r\n\t\timageFit: 'aspectFill',\r\n\t\tdisablePreview: false,\r\n\t\tautoUpload: false,\r\n\t\tmultiple: true,\r\n\t\tmax: 0,\r\n\t\tdisabled: false,\r\n\t\treadonly: false,\r\n\t\tmediaType: 'image',\r\n\t\tsizeType: ['original', 'compressed'],\r\n\t\tsourceType: ['album', 'camera'],\r\n\t\tuploadIcon: 'camera',\r\n\t\tloadingText: '上传中...',\r\n\t\treloadText: '重新上传',\r\n\t\tfailedText: '上传失败',\r\n\t\tmode: 'grid'\r\n\t})\r\n\r\n\tconst isReadonly = computed(() : boolean => {\r\n\t\tconsole.log('isReadonly', props.readonly)\r\n\t\tif (props.readonly) return props.readonly;\r\n\t\treturn formReadonly?.value ?? false;\r\n\t})\r\n\tconst isDisabled = computed(() : boolean => {\r\n\t\tif (props.disabled) return props.disabled;\r\n\t\treturn formDisabled?.value ?? false;\r\n\t})\r\n\r\n\tconst transformFiles = (it : any) : UploadFile => {\r\n\r\n\t\tif (it instanceof UploadFile) {\r\n\t\t\treturn it\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\tconst file = UTSJSONObject.assign({}, it as UTSJSONObject) //it as UTSJSONObject\r\n\r\n\t\treturn {\r\n\t\t\turl: file.getString('url') ?? '',\r\n\t\t\tpath: file.getString('path'),\r\n\t\t\tname: file.getString('name'),\r\n\t\t\tthumb: file.getString('thumb'),\r\n\t\t\tsize: file.getNumber('size'),\r\n\t\t\ttype: file.getString('type'),\r\n\t\t\tpercent: file.getNumber('percent'),\r\n\t\t\tstatus: file.getString('status') ?? 'done',\r\n\t\t} as UploadFile\r\n\t}\r\n\tconst customFiles = ref<UploadFile[]>((props.modelValue ?? props.defaultFiles)?.map(transformFiles) ?? []);\r\n\r\n\tconst listWidth = ref(0);\r\n\tconst uploadRef = ref<UniElement | null>(null);\r\n\tconst styles = computed(() : Map<string, any> => {\r\n\t\tconst style = new Map<string, any>();\r\n\t\tconst gutter = unitConvert(props.gutter ?? 8) / 2 * -1\r\n\t\tstyle.set('margin-left', `${gutter}px`)\r\n\t\tstyle.set('margin-right', `${gutter}px`)\r\n\t\tstyle.set('margin-top', `${gutter}px`)\r\n\t\treturn style\r\n\t})\r\n\tconst itemStyle = computed(() : Map<string, any> => {\r\n\t\tconst style = new Map<string, any>();\r\n\r\n\t\t// const gridWidth = unitConvert(props.gridWidth ?? 80)\r\n\t\tconst gutter = unitConvert(props.gutter ?? 8) / 2\r\n\t\tlet column = props.column ?? 4;\r\n\r\n\t\tif (props.gridWidth != null || props.column != null) {\r\n\r\n\t\t\tconst width = listWidth.value / column - gutter * 2.0275;// ios 计算精度导致不均分\r\n\t\t\tstyle.set('width', props.gridWidth ?? `${width}px`)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t}\r\n\r\n\r\n\t\tif (props.gridHeight != null) {\r\n\t\t\tstyle.set('height', props.gridHeight!)\r\n\t\t}\r\n\t\tstyle.set('margin', `${gutter}px`)\r\n\t\tif (props.gridBgColor != null) {\r\n\t\t\tstyle.set('background', props.gridBgColor!)\r\n\t\t}\r\n\r\n\t\treturn style\r\n\t})\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tconst onFileClick = (index : number) => {\r\n\t\tconst file = customFiles.value[index]\r\n\t\temits('click', { file })\r\n\t}\r\n\tconst onProofTap = (index : number) => {\r\n\t\tonFileClick(index);\r\n\t\tif (props.disablePreview) return\r\n\t\tuni.previewImage({\r\n\t\t\turls: customFiles.value.filter((file) : boolean => file.percent != -1).map((file) : string => file.url),\r\n\t\t\tcurrent: index\r\n\t\t});\r\n\t}\r\n\tconst onDelete = (index : number) => {\r\n\t\tif (isDisabled.value || isReadonly.value) return;\r\n\t\tconst delFile = customFiles.value[index]\r\n\t\tcustomFiles.value = customFiles.value.filter((file, i) : boolean => index != i)\r\n\t\temits('remove', { index, file: delFile })\r\n\t}\r\n\r\n\tlet last : number// = 0\r\n\tconst upload = (files : UploadFile[]) => {\r\n\t\tif (!props.autoUpload || props.action == null || props.action!.length < 5) return\r\n\t\tif (props.action == 'uniCloud') {\r\n\t\t\tlet uploadImgs : Promise<UniCloudUploadFileResult>[] = [];\r\n\t\t\tfiles.forEach((file, index) => {\r\n\t\t\t\t// props.beforeRead(file).then((res)=>{})\r\n\r\n\t\t\t\tconst promise = new Promise<UniCloudUploadFileResult>((resolve, reject) => {\r\n\t\t\t\t\tconst dotIndex = file.name!.lastIndexOf('.'); // 找到最后一个点的位置\r\n\t\t\t\t\tconst baseName = file.name!.substring(0, dotIndex);\r\n\t\t\t\t\tconst extension = file.name!.substring(dotIndex);\r\n\t\t\t\t\tconst timestamp = Date.now();\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\tuniCloud.uploadFile({\r\n\t\t\t\t\t\tfilePath: file.url,\r\n\t\t\t\t\t\tcloudPath: `${baseName}_${timestamp}${extension}`,\r\n\t\t\t\t\t\t// cloudPath: file.name!.substring(file.name!.lastIndexOf('.')),\r\n\t\t\t\t\t\tonUploadProgress: (res) => {\r\n\t\t\t\t\t\t\tfile.status = 'loading'\r\n\t\t\t\t\t\t\tfile.percent = Math.floor(res.loaded / res.total * 100)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}).then(res => {\r\n\t\t\t\t\t\tfile.path = res.fileID;\r\n\t\t\t\t\t\tfile.status = 'done'\r\n\t\t\t\t\t\t// 获取临时URL\r\n\t\t\t\t\t\tuniCloud.getTempFileURL({\r\n\t\t\t\t\t\t\tfileList: [res.fileID]\r\n\t\t\t\t\t\t}).then(result => {\r\n\t\t\t\t\t\t\tif (result.fileList.length > 0) {\r\n\t\t\t\t\t\t\t\tfile.url = result.fileList[0].tempFileURL;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t\t}).catch(error => {\r\n\t\t\t\t\t\t\tconsole.error('获取临时URL失败', error);\r\n\t\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// resolve(res)\r\n\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\tfile.status = 'failed'\r\n\t\t\t\t\t\treject(err)\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\tuploadImgs.push(promise as Promise<UniCloudUploadFileResult>)\r\n\t\t\t})\r\n\r\n\t\t\tPromise.all(uploadImgs).then(res => {\r\n\t\t\t\temits('success', res)\r\n\t\t\t}).catch(err => {\r\n\t\t\t\temits('fail', err)\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tlet uploadImgs : Promise<UploadFileSuccess>[] = [];\r\n\t\t\tfiles.forEach((file, index) => {\r\n\t\t\t\tconst promise = new Promise<UploadFileSuccess>((resolve, reject) => {\r\n\t\t\t\t\tconst task = uni.uploadFile({\r\n\t\t\t\t\t\turl: props.action!,\r\n\t\t\t\t\t\tfilePath: file.url,\r\n\t\t\t\t\t\tname: file.name,\r\n\t\t\t\t\t\tformData: props.formData,\r\n\t\t\t\t\t\theader: props.headers,\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tfile.status = 'done'\r\n\t\t\t\t\t\t\tif (res.statusCode == 200) {\r\n\t\t\t\t\t\t\t\tif (typeof res.data == 'string') {\r\n\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\tconst data = JSON.parse<UTSJSONObject>(res.data);\r\n\t\t\t\t\t\t\t\t\t\tconst url = data?.getString('url');\r\n\t\t\t\t\t\t\t\t\t\tif (url != null) {\r\n\t\t\t\t\t\t\t\t\t\t\tfile.path = url\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\t\t//TODO handle the exception\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\tfile.status = 'failed'\r\n\t\t\t\t\t\t\treject(err)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\ttask.onProgressUpdate((res) => {\r\n\t\t\t\t\t\tfile.status = 'loading'\r\n\t\t\t\t\t\tfile.percent = res.progress\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\tuploadImgs.push(promise as Promise<UploadFileSuccess>)\r\n\t\t\t})\r\n\t\t\tPromise.all(uploadImgs).then(res => {\r\n\t\t\t\temits('success', res)\r\n\t\t\t}).catch(err => {\r\n\t\t\t\temits('fail', err)\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst customLimit = computed(() : number => props.max == 0 ? 20 : props.max - customFiles.value.length)\r\n\tconst onAddTap = () => {\r\n\t\tif (isDisabled.value || isReadonly.value) return;\r\n\t\tchooseFiles({\r\n\t\t\tmediaType: props.mediaType,\r\n\t\t\tcount: customLimit.value,\r\n\t\t\tsourceType: props.sourceType,\r\n\t\t\tsizeType: props.sizeType,\r\n\t\t\tsizeLimit: props.sizeLimit\r\n\t\t} as ChooseFileOptions).then((files) => {\r\n\t\t\tlast = customFiles.value.length\r\n\t\t\tcustomFiles.value = customFiles.value.concat(files)\r\n\t\t\t// @ts-ignore\r\n\t\t\tconst _files = customFiles.value.filter((it, i) : boolean => i > last - 1)\r\n\t\t\tupload(_files)\r\n\t\t\temits('add', _files)\r\n\t\t})\r\n\t}\r\n\r\n\r\n\r\n\r\n\tconst stop = watch(customFiles, (v : UploadFile[]) => {\r\n\t\temits('update:modelValue', v)\r\n\t})\r\n\r\n\tconst stopValue = watch(() : (UTSJSONObject[] | null) => props.modelValue, (v : UTSJSONObject[] | null) => {\r\n\t\tif (v != null && v.length != customFiles.value.length) {\r\n\t\t\tcustomFiles.value = v.map(transformFiles)\r\n\t\t}\r\n\t})\r\n\r\n\tdefineExpose({\r\n\t\tremove: onDelete\r\n\t})\r\n\r\n\r\n\tconst resizeObserver = new UniResizeObserver((entries : Array<UniResizeObserverEntry>) => {\r\n\t\tlistWidth.value = entries[0].target.getBoundingClientRect().width\r\n\t})\r\n\r\n\tonMounted(() => {\r\n\t\tnextTick(() => {\r\n\t\t\tlistWidth.value = uploadRef.value?.getBoundingClientRect().width ?? 0;\r\n\t\t\tresizeObserver.observe(uploadRef.value!)\r\n\t\t})\r\n\t})\r\n\r\n\r\n\tonUnmounted(() => {\r\n\t\tstop()\r\n\r\n\t\tresizeObserver.disconnect()\r\n\r\n\t})\r\n</script>\r\n<style lang=\"scss\">\r\n\t@import './index';\r\n</style>",null],"names":[],"mappings":"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"}