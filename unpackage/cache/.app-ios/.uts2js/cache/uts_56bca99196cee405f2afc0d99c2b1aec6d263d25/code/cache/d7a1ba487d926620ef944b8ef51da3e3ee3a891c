{"code":"// 安全计算函数\nexport function calculateTimeline(params) {\n    // 参数校验\n    if (!params || params.duration <= 0 || params.width <= 0) {\n        uni.__log__('error', 'at uts/timelineEngine.uts:27', \"Invalid timeline parameters\");\n        return [];\n    }\n    const results = [];\n    const safeDuration = Math.max(1, params.duration);\n    const pxPerSecond = params.width / safeDuration;\n    const safeDensity = Math.max(1, Math.min(60, params.density));\n    // 可见区域边界\n    const visibleStart = Math.max(0, params.visibleRange.start);\n    const visibleEnd = Math.min(safeDuration, params.visibleRange.end);\n    // 生成时间标记\n    for (let minute = 0; minute <= safeDuration / 60; minute += safeDensity) {\n        const timestamp = minute * 60;\n        if (timestamp < visibleStart || timestamp > visibleEnd)\n            continue;\n        results.push({\n            timestamp,\n            position: calculatePosition(timestamp, pxPerSecond),\n            label: formatTimeLabel(minute),\n            hasEvent: checkEventPresence(timestamp, params.events, safeDensity)\n        });\n    }\n    return results;\n}\n// 安全位置计算\nfunction calculatePosition(timestamp, pxPerSecond) {\n    const pos = timestamp * pxPerSecond;\n    return isNaN(pos) ? 0 : pos;\n}\n// 事件检测\nfunction checkEventPresence(timestamp, events, density) {\n    if (!events || !events.length)\n        return false;\n    return events.some(e => { return Math.abs(e.timestamp - timestamp) < (density * 30); });\n}\n// 时间格式化\nfunction formatTimeLabel(totalMinutes) {\n    const hours = Math.floor(totalMinutes / 60);\n    const mins = totalMinutes % 60;\n    return `${padZero(hours)}:${padZero(mins)}`;\n}\n// 补零函数\nfunction padZero(num) {\n    return num.toString().padStart(2, '0');\n}\n// 波浪计算器 (iOS特别优化)\nexport function calculateWavePosition(timestamp, currentTime) {\n    if (isNaN(timestamp))\n        return 0;\n    const timeDiff = Math.min(Math.abs(timestamp - currentTime), 300);\n    const amplitude = 30 * (1 - timeDiff / 300);\n    return amplitude * Math.sin(timestamp * Math.PI / 180);\n}\n//# sourceMappingURL=/Users/xyhc/Documents/veepai_uniappx/uts/timelineEngine.uts.js.map","references":[],"uniExtApis":["uni.__log__"],"map":"{\"version\":3,\"file\":\"timelineEngine.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"timelineEngine.uts\"],\"names\":[],\"mappings\":\"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\"}"}
