{"version":3,"sources":["uni_modules/lime-badge/components/l-badge/l-badge.uvue"],"names":[],"mappings":"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","sourcesContent":["<template>\n\t<view class=\"l-badge__wrapper\" v-if=\"$slots['default'] != null\">\n\t\t<slot></slot>\n\t\t<text v-if=\"hasContent || dot\" class=\"l-badge\" ref=\"textRef\" :class=\"classes\" :style=\"[styles]\">\n\t\t\t<slot name=\"content\">{{renderContent}}</slot>\n\t\t</text>\n\n\t\t<text v-if=\"hasContent || dot\" class=\"l-badge l-badge--offscreen\" ref=\"offscreenRef\" :class=\"classes\" :style=\"[styles]\">\n\t\t\t<slot name=\"content\">{{renderContent}}</slot>\n\t\t</text>\n\n\t</view>\n\t<text v-else-if=\"hasContent || dot\" class=\"l-badge\" :class=\"classes\" :style=\"[styles]\">\n\t\t<slot name=\"content\">{{renderContent}}</slot>\n\t</text>\n</template>\n<script lang=\"uts\" setup>\n\t/**\n\t * Badge 徽标组件\n\t * @description 用于展示状态标记、消息数量等提示信息，支持多种形态和定位方式\n\t * <br> 插件类型：LBadgeComponentPublicInstance \n\t * @tutorial https://ext.dcloud.net.cn/plugin?name=lime-badge\n\t * \n\t * @property {string} [color] 徽标背景色（支持CSS颜色值）\n\t * @property {number | string | any} content 显示内容（数字/文字）\n\t * @property {boolean} dot 是否显示为小红点（优先级高于content）\n\t * @property {number} max 数字最大值（超出显示为${max}+）\n\t * @property {Array<string | number> | any[]} offset 位置偏移量（[x, y]）\n\t * @property {'top-right' | 'top-left' | 'bottom-right' | 'bottom-left'} position 定位位置\n\t * @property {'circle' | 'square' | 'bubble' | 'ribbon'} [shape] 形状（当前版本未实现）\n\t * @property {boolean} showZero 数值为0时是否显示\n\t * @property {'medium' | 'large'} [size] 尺寸（当前版本未实现）\n\t * @property {string | number} [content] 支持字符串模板（例：'${count}条'）\n\t * @property {Array<string | number>} offset 支持单位（例：['-10rpx', '20px']）\n\t */\n\t\n\timport { isNumeric } from '@/uni_modules/lime-shared/isNumeric'\n\timport { isNumber } from '@/uni_modules/lime-shared/isNumber'\n\timport { addUnit } from '@/uni_modules/lime-shared/addUnit'\n\timport { toBoolean } from '@/uni_modules/lime-shared/toBoolean'\n\timport { getOffsetWithMinusString } from './utils'\n\timport { BadgeProps } from './type'\n\tconst name = 'l-badge'\n\tconst props = withDefaults(defineProps<BadgeProps>(), {\n\t\tdot: false,\n\t\tmax: 99,\n\t\tshowZero: false,\n\n\t\toffset: [] as any[],\n\n\n\n\n\t\tposition: 'top-right'\n\t})\n\t\n\t\n\t\n\tconst context = getCurrentInstance()!\n\tconst classes = computed(():Map<string, boolean>=>{\n\t\tconst cls = new Map<string, boolean>()\n\t\tcls.set(`${name}--fixed`, toBoolean(context.slots['default']));\n\t\tcls.set(`${name}--dot`, props.dot);\n\t\tcls.set(`${name}--${props.position}`, context.slots['default'] != null);\n\t\treturn cls\n\t})\n\tconst styles = computed(():Map<string, any|null>=>{\n\t\tconst style = new Map<string, any|null>()\n\t\tif(toBoolean(props.color)) {\n\t\t\tstyle.set('background', props.color!)\n\t\t}\n\t\tconst positions = props.position.split('-');\n\t\tconst offset = props.offset;\n\t\tif(offset.length == 2) {\n\t\t\tconst x = offset[0];\n\t\t\tconst y = offset[1];\n\t\t\tif(context.slots['default'] != null) {\n\t\t\t\tif(positions.length == 2) {\n\t\t\t\t\tconst offsetY = positions[0], offsetX = positions[1];\n\t\t\t\t\tif(isNumber(y)) {\n\t\t\t\t\t\tconst _y = y as number\n\t\t\t\t\t\tstyle.set(offsetY, addUnit(offsetY == 'top' ? _y : -_y))\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstyle.set(offsetY, offsetY == 'top' ? addUnit(y) : getOffsetWithMinusString(`${y}`))\n\t\t\t\t\t}\n\t\t\t\t\tif(isNumber(x)) {\n\t\t\t\t\t\tconst _x = x as number\n\t\t\t\t\t\tstyle.set(offsetX, addUnit(offsetX == 'left' ? _x : -_x))\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstyle.set(offsetY, offsetY == 'left' ? addUnit(x) : getOffsetWithMinusString(`${x}`))\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstyle.set('margin-top', addUnit(y))\n\t\t\t\tstyle.set('margin-left', addUnit(x))\n\t\t\t}\n\t\t}\n\t\treturn style\n\t});\n\tconst hasContent = computed<boolean>(():boolean => {\n\t\tif(toBoolean(context.slots['content'])) {\n\t\t\treturn true\n\t\t}\n\t\tconst content = props.content;\n\t\treturn (content != '' && content != null && (props.showZero || content !== '0'));\n\t});\n\tconst renderContent = computed<string>(():string=>{\n\t\tconst dot = props.dot\n\t\tconst max = props.max\n\t\tconst content = props.content\n\t\tif(!dot && hasContent.value) {\n\t\t\tif(max != 0 && isNumeric(content) && parseFloat(content.toString()) > max) {\n\t\t\t\treturn `${max}+`\n\t\t\t}\n\t\t}\n\t\tif(dot) {\n\t\t\treturn ''\n\t\t}\n\t\treturn `${content ?? \"\"}`\n\t})\n\t\n\n\t// 安卓BUG 父级设置横向居中，子text定位absolute时宽度受限 https://issues.dcloud.net.cn/pages/issues/detail?id=11847\n\t// 暂时先绕一下\n\tconst textRef = ref<UniTextElement|null>(null)\n\tconst offscreenRef = ref<UniTextElement|null>(null)\n\tconst resizeObserver = new UniResizeObserver((entries : Array<UniResizeObserverEntry>) => {\n\t\tconst width = entries[0].target.getBoundingClientRect().width\n\t\ttextRef.value!.style.setProperty('width', width*1.05)\n\t}) \n\t\n\tconst stopWatch = watch(offscreenRef, (el:UniElement|null) => {\n\t\tif(el== null) return\n\t\tresizeObserver.observe(el)\n\t})\n\t\n\tonUnmounted(()=>{\n\t\tstopWatch()\n\t\tresizeObserver.disconnect()\n\t})\n\n\t\n</script>\n<style lang=\"scss\">\n\t@import './index-u';\n</style>"]}