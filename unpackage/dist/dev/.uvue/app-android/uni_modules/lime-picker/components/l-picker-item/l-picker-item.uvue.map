{"version":3,"sources":["uni_modules/lime-picker/components/l-picker-item/l-picker-item.uvue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<picker-view \r\n\t\tclass=\"l-picker-item__group\"\r\n\t\t:style=\"{opacity: options.length > 0 ? 1 : 0}\"\r\n\t\t:indicator-style=\"indicatorStyles\" \r\n\t\t:value=\"innerIndex\" \r\n\t\t@change=\"handlePick\"\r\n\t\tindicator-class=\"l-picker-item__indicator\">\r\n\t\t<picker-view-column class=\"l-picker-item__wrapper\">\r\n\r\n\t\t\t<view ref=\"itemRef\"></view>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t</picker-view-column>\r\n\t</picker-view>\r\n</template>\r\n<script lang=\"uts\" setup>\r\n\t/**\r\n\t * PickerItem 选择器子项组件\r\n\t * @description 用于构建多列选择器的单个列项，通常作为 Picker 组件的子组件使用\r\n\t * <br>插件类型：LPickerItemComponentPublicInstance \r\n\t * @tutorial https://ext.dcloud.net.cn/plugin?name=lime-picker\r\n\t * \r\n\t * @property {PickerColumnItem[]} options 当前列的选项列表（必填）\r\n\t * @property {PickerValue} value 当前选中值\r\n\t * @property {number} column 列索引标识（从0开始计数）\r\n\t * @property {string | number} name 列名称标识符\r\n\t */\r\n\timport { unitConvert } from '@/uni_modules/lime-shared/unitConvert'\r\n\timport { clamp } from '@/uni_modules/lime-shared/clamp'\r\n\timport { PickerItemProps, ManageChildInList, OnPick, UpdateItems } from './type';\r\n\timport { PickerColumnItem, PickerValue } from '../l-picker/type';\r\n\tconst instance = getCurrentInstance()!;\r\n\tconst props = withDefaults(defineProps<PickerItemProps>(), {\r\n\t\toptions: [] as PickerColumnItem[],\r\n\t\tcolumn: -1,\r\n\t\tresetIndex: false\r\n\t})\r\n\tconst picker = inject<LPickerComponentPublicInstance | null>('limePicker', null);\r\n\tconst pickerItemInstanceArray = inject<LPickerItemComponentPublicInstance[] | null>('limePickerItems', null);\r\n\tconst manageChildInList = inject<ManageChildInList | null>('limePickerManageChildInList', null);\r\n\tmanageChildInList?.(instance.proxy! as LPickerItemComponentPublicInstance, true)\r\n\tconst onPick = inject<OnPick | null>('limePickerOnPick', null);\r\n\tconst updateItems = inject<UpdateItems | null>('limePickerUpdateItems', null);\r\n\t// web 如果初始是0 当数据加载后 无法指向0\r\n\r\n\r\n\r\n\r\n\tconst curIndex = ref(0)\r\n\r\n\tconst curValue = ref<PickerValue | null>(props.value);\r\n\tconst column = computed(() : number => props.column != -1 ? props.column : pickerItemInstanceArray?.indexOf(instance.proxy! as LPickerItemComponentPublicInstance) ?? props.column);\r\n\r\n\tconst elementPosition = computed(() : boolean[] => {\r\n\t\tconst totalElements = pickerItemInstanceArray?.length ?? 0;\r\n\t\treturn [column.value == 0, column.value == totalElements - 1]\r\n\t});\r\n\tconst innerIndex = computed(() : number[] => [curIndex.value])\r\n\tconst indicatorStyles = computed(() : string => {\r\n\t\tconst [isFirst, isLast] = elementPosition.value\r\n\t\tlet style = ``\r\n\t\t\r\n\t\tif(isFirst) {\r\n\t\t\tstyle+= 'border-top-left-radius:12rpx; border-bottom-left-radius:12rpx;'\r\n\t\t}\r\n\t\tif(isLast) {\r\n\t\t\tstyle+= 'border-top-right-radius:12rpx; border-bottom-right-radius:12rpx;'\r\n\t\t}\r\n\t\treturn `\r\n\t\t\t${style}\r\n\t\t\theight: ${picker?.itemHeight ?? '50px'};\r\n\t\t\tbackground-color: rgba(0, 0, 0, 0.04); ${picker?.indicatorStyle}`\r\n\t})\r\n\tconst itemStyles = computed(() : Map<string, any> => {\r\n\t\tconst style = new Map<string, any>();\r\n\t\tif (picker?.itemColor != null) {\r\n\t\t\tstyle.set('color', picker.itemColor!)\r\n\t\t}\r\n\t\tif (picker?.itemFontSize != null) {\r\n\t\t\tstyle.set('font-size', picker.itemFontSize!)\r\n\t\t}\r\n\t\tif(picker?.itemHeight != null) {\r\n\t\t\tstyle.set('line-height', picker.itemHeight!)\r\n\t\t\tstyle.set('height', picker.itemHeight!)\r\n\t\t}\r\n\t\treturn style\r\n\t})\r\n\tconst itemActiveStyles = computed(() : Map<string, any> => {\r\n\t\tconst style = new Map<string, any>();\r\n\t\tif (picker?.itemActiveColor != null) {\r\n\t\t\tstyle.set('color', picker.itemActiveColor!)\r\n\t\t}\r\n\t\tif (picker?.itemActiveFontWeight != null) {\r\n\t\t\tstyle.set('font-weight', picker.itemActiveFontWeight!)\r\n\t\t}\r\n\t\treturn style\r\n\t})\r\n\r\n\r\n\tconst getIndexByValue = (val : PickerValue | null) => {\r\n\t\tlet defaultIndex = 0;\r\n\t\tif (val != null) {\r\n\t\t\tdefaultIndex = props.options.findIndex((item) => item.value == val);\r\n\t\t}\r\n\t\treturn defaultIndex < 0 ? 0 : defaultIndex;\r\n\t};\r\n\r\n\tconst setIndex = (index : number) => {\r\n\t\tlet lastIndex = curIndex.value\r\n\t\tlet _index = clamp(index, 0,  props.options.length - 1)\r\n\t\tif(props.options.length > _index) {\r\n\t\t\tcurIndex.value = _index;\r\n\t\t\tcurValue.value = props.options[_index].value\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t\r\n\t}\r\n\tconst setValue = (value : PickerValue | null) => {\r\n\t\tif (value == curValue.value) return\r\n\t\tcurValue.value = value\r\n\t\tconst index = getIndexByValue(value)\r\n\t\tsetIndex(index)\r\n\t}\r\n\tconst setOptions = () => { }\r\n\tconst setUpdateItems = () => {\r\n\t\tconst index = clamp(curIndex.value, 0,  props.options.length - 1)\r\n\t\tconst curItem = props.options.length > index ? props.options[index] : null;\r\n\t\tif (curItem == null) return\r\n\t\tupdateItems?.(curItem, index, column.value);\r\n\t}\r\n\t\r\n\tconst handlePick = (e : UniPickerViewChangeEvent) => {\r\n\t\tif(props.options.length == 0) return\r\n\t\tconst index = clamp(e.detail.value[0], 0,  props.options.length - 1);\r\n\t\tconst curItem = props.options[index];\r\n\t\tif(index == curIndex.value) return\r\n\t\tsetIndex(index)\r\n\t\tonPick?.(curItem, index, column.value);\r\n\t}\r\n\r\n\tconst stopValue = watch(() : PickerValue | null => props.value, (v : PickerValue | null) => {\r\n\t\tsetValue(v);\r\n\t\tsetUpdateItems();\r\n\t}, { immediate: true })\r\n\r\n\r\n\tconst itemRef = ref<UniElement | null>(null)\r\n\tconst updateItemStyle = () => {\r\n\t\tif (itemRef.value != null) {\r\n\t\t\tconst ctx = itemRef.value!.getDrawableContext()!\r\n\t\t\tconst height = unitConvert(picker?.itemHeight ?? 50);\r\n\t\t\tconst fontSize = unitConvert(picker?.itemFontSize ?? '32rpx');\r\n\t\t\tconst rect = itemRef.value!.getBoundingClientRect()\r\n\t\t\tconst x = itemRef.value!.offsetWidth / 2;\r\n\t\t\tconst itemActiveFontWeight = picker?.itemActiveFontWeight ?? 700\r\n\t\t\titemRef.value!.style.setProperty('height', height * props.options.length);\r\n\t\t\tctx.reset()\r\n\t\t\tctx.fillStyle = picker?.itemActiveColor ?? 'rgba(0,0,0,0.88)';\r\n\t\t\tctx.font = `${fontSize}px`;\r\n\t\t\tctx.textAlign = 'center'\r\n\t\t\tctx.lineWidth = 0.5\r\n\t\t\t\r\n\t\t\tprops.options.forEach((item, index) => {\r\n\t\t\t\tconst y = height * index + fontSize + (height - fontSize) * 0.4;  //(height - fontSize * 1.1)\r\n\t\t\t\tctx.fillText(item.label, x, y)\r\n\t\t\t\tif (index == curIndex.value && itemActiveFontWeight > 600) {\r\n\t\t\t\t\tctx.strokeText(item.label, x, y)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tctx.update()\r\n\t\t}\r\n\t}\r\n\t// 防止更新后尺寸不对\r\n\twatchEffect(()=> {\r\n\t\tif(curIndex.value > 0){}\r\n\t\tnextTick(updateItemStyle)\r\n\t})\r\n\tconst stop = watch(() : PickerColumnItem[] => props.options, (v : PickerColumnItem[], o : PickerColumnItem[]) => {\r\n\t\tnextTick(updateItemStyle)\r\n\t})\r\n\t\r\n\tconst resizeObserver = new UniResizeObserver((entries : Array<UniResizeObserverEntry>) => {\r\n\t\tupdateItemStyle()\r\n\t}) \r\n\tconst stopWatch = watch(():UniElement|null => itemRef.value, (el:UniElement|null) => {\r\n\t\tif(el== null) return\r\n\t\tresizeObserver.observe(el)\r\n\t})\r\n\t// onMounted(() => {\r\n\t// \tnextTick(updateItemStyle)\r\n\t// })\r\n\t\r\n\r\n\tonBeforeUnmount(() => {\r\n\t\tmanageChildInList?.(instance.proxy! as LPickerItemComponentPublicInstance, false)\r\n\t\t\r\n\r\n\t\tstop()\r\n\t\tstopWatch()\r\n\t\tresizeObserver.disconnect()\r\n\r\n\t})\r\n\t// onMounted(()=>{\r\n\t// \tif(props.options.length > 0 && curIndex.value == -1) {\r\n\t// \t\tcurIndex.value = 0\r\n\t// \t}\r\n\t// })\r\n\tdefineExpose({\r\n\t\tsetIndex,\r\n\t\tsetValue,\r\n\t\t// setOptions,\r\n\t\t// setUpdateItems,\r\n\t\tgetIndexByValue\r\n\t})\r\n</script>\r\n<style lang=\"scss\">\r\n\t@import './index';\r\n</style>"]}