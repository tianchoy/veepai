{"version":3,"sources":["uni_modules/lime-upload/components/l-upload/l-upload.uvue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<view class=\"l-upload\" ref=\"uploadRef\" :style=\"styles\">\r\n\t\t<view class=\"l-upload__item\" v-for=\"(file, index) in customFiles\" :style=\"[itemStyle]\" :key=\"file.url\">\r\n\r\n\r\n\r\n\t\t\t\t<slot name=\"file\" :file=\"file\" :index=\"index\">\r\n\t\t\t\t\t<image class=\"l-upload__image\" v-if=\"file.type == 'image'\" :src=\"file.url\" :data-file=\"file\"\r\n\t\t\t\t\t\t:mode=\"imageFit\" @click=\"onProofTap(index)\" />\r\n\t\t\t\t\t<video class=\"l-upload__image\" v-if=\"file.type == 'video'\" :src=\"file.url\" :data-file=\"file\"\r\n\t\t\t\t\t\t:autoplay=\"false\" objectFit=\"contain\" @click=\"onFileClick(index)\" />\r\n\t\t\t\t\t<view class=\"l-upload__progress-mask\" v-if=\"file.status != null && file.status != 'done'\"\r\n\t\t\t\t\t\t:data-file=\"file\" @click=\"onFileClick(index)\">\r\n\t\t\t\t\t\t<template v-if=\"file.status == 'loading'\">\r\n\t\t\t\t\t\t\t<l-loading class=\"l-upload__progress-loading\" size=\"24px\" color=\"white\" />\r\n\t\t\t\t\t\t\t<text class=\"l-upload__progress-text\" v-if=\"file.percent != null\">{{file.percent}}%</text>\r\n\t\t\t\t\t\t\t<text class=\"l-upload__progress-text\" v-else>{{loadingText}}</text>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<l-icon v-else class=\"l-upload__progress-icon\"\r\n\t\t\t\t\t\t\t:name=\"file.status == 'reload' ? 'refresh' : 'close-circle'\" size=\"48rpx\" aria-hidden />\r\n\t\t\t\t\t\t<text v-if=\"file.status == 'reload' || file.status == 'failed'\" class=\"l-upload__progress-text\">\r\n\t\t\t\t\t\t\t{{file.status == 'reload' ? reloadText : failedText}}\r\n\t\t\t\t\t\t</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view v-if=\"!isReadonly\" class=\"l-upload__delete-btn\" aria-role=\"button\" aria-label=\"删除\" :data-index=\"index\"\r\n\t\t\t\t\t\t@click=\"onDelete(index)\">\r\n\t\t\t\t\t\t<l-icon name=\"close\" size=\"16px\" color=\"#fff\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</slot>\r\n\r\n\r\n\r\n\t\t</view>\r\n\r\n\t\t<view class=\"l-upload__item l-upload__item--add\" :class=\"{'l-upload__item--disabled':isDisabled}\"\r\n\t\t\tv-if=\"!isReadonly\"\r\n\t\t\tv-show=\"!multiple ? customFiles.length == 0 : max == 0 || customFiles.length != max\"\r\n\t\t\t:style=\"[itemStyle,  addBgColor!=null ? {background: addBgColor}: '']\" aria-label=\"上传\" @click=\"onAddTap\">\r\n\t\t\t<slot>\r\n\t\t\t\t<l-icon class=\"l-upload__add-icon\" :size=\"uploadIconSize\" :name=\"uploadIcon\" />\r\n\t\t\t</slot>\r\n\t\t</view>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t</view>\r\n</template>\r\n<script lang=\"uts\" setup>\r\n\t/**\r\n\t * Upload 文件上传组件\r\n\t * @description 用于图片、视频等文件的上传，支持预览、删除、重传等功能\r\n\t * <br>插件类型：LUploadComponentPublicInstance \r\n\t * @tutorial https://ext.dcloud.net.cn/plugin?name=lime-upload\r\n\t * \r\n\t * @property {string} name 表单字段名\r\n\t * @property {UTSJSONObject[]} modelValue 已上传文件列表（支持v-model）\r\n\t * @property {boolean} disabled 是否禁用（默认：false）\r\n\t * @property {boolean} readonly 只读（默认：false）\r\n\t * @property {boolean} multiple 是否支持多选（默认：false）\r\n\t * @property {'scaleToFill'|'aspectFit'|'aspectFill'|'widthFix'|'heightFix'|'top'|'bottom'|'center'|'left'|'right'|'top left'|'top right'|'bottom left'|'bottom right'} imageFit 图片裁剪模式（默认：\"aspectFill\"）\r\n\t * @value scaleToFill\r\n\t * @value aspectFit\r\n\t * @value aspectFill\r\n\t * @value widthFix\r\n\t * @value heightFix\r\n\t * @value top\r\n\t * @value bottom\r\n\t * @value 'top left'\r\n\t * @value 'top right'\r\n\t * @value 'bottom left'\r\n\t * @value \"bottom right\"\r\n\t * @property {string} gutter 项目间距（支持CSS单位）\r\n\t * @property {number} column 每行显示数量（默认：4）\r\n\t * @property {number} max 最大上传数量（默认：9）\r\n\t * @property {number} sizeLimit 文件大小限制（单位KB）\r\n\t * @property {string} uploadIcon 上传按钮图标\r\n\t * @property {string} uploadIconSize 上传按钮图标尺寸\r\n\t * @property {string} gridWidth 项目宽度（支持CSS单位）\r\n\t * @property {string} gridHeight 项目高度（支持CSS单位）\r\n\t * @property {string} gridBgColor 项目背景色\r\n\t * @property {string} addBgColor 添加按钮背景色\r\n\t * @property {string} gridBorderRadius 项目圆角\r\n\t * @property {UTSJSONObject[]} defaultFiles 默认文件列表\r\n\t * @property {string} loadingText 上传中提示文字\r\n\t * @property {string} reloadText 重传提示文字\r\n\t * @property {string} failedText 失败提示文字\r\n\t * @property {boolean} disablePreview 禁用预览（默认：false）\r\n\t * @property {boolean} autoUpload 自动上传（默认：true）\r\n\t * @property {'image' | 'video' | 'all' | 'media'} mediaType 上传文件类型（默认：\"image\"）\r\n\t * @value image\r\n\t * @value video\r\n\t * @value media\r\n\t * @value all\r\n\t * @property {number} maxDuration 视频最大时长（秒）\r\n\t * @property {string[]} sizeType 文件尺寸类型（默认：[\"original\", \"compressed\"]）\r\n\t * @property {string[]} sourceType 文件来源（默认：[\"album\", \"camera\"]）\r\n\t * @property {string} action 上传地址（uniCloud服务请设置为\"uniCloud\"）\r\n\t * @property {UTSJSONObject} headers 请求头部\r\n\t * @property {UTSJSONObject} formData 额外表单数据\r\n\t * @property {string} mode 显示模式（默认：\"grid\"）\r\n\t * @event {Function} add 点击增加时触发\r\n\t * @event {Function} success 上传成功时触发\r\n\t * @event {Function} fail 上传失败时触发\r\n\t * @event {Function} remove 点击删除时触发\r\n\t * @event {Function} click 点击时触发\r\n\t */\r\n\r\n\timport { unitConvert } from '@/uni_modules/lime-shared/unitConvert'\r\n\timport { chooseFiles } from './utils'\r\n\timport { UploadProps, UploadFile, ChooseFileOptions } from './type';\r\n\r\n\tdefineSlots<{\r\n\t\tfile(props : { file : UploadFile, index : number }) : any,\r\n\t}>()\r\n\r\n\tconst formDisabled = inject<Ref<boolean | null> | null>('formDisabled', null)\r\n\tconst formReadonly = inject<Ref<boolean | null> | null>('formReadonly', null)\r\n\r\n\tconst emits = defineEmits(['fail', 'remove', 'success', 'click', 'add', 'update:modelValue'])\r\n\tconst props = withDefaults(defineProps<UploadProps>(), {\r\n\t\timageFit: 'aspectFill',\r\n\t\tdisablePreview: false,\r\n\t\tautoUpload: false,\r\n\t\tmultiple: true,\r\n\t\tmax: 0,\r\n\t\tdisabled: false,\r\n\t\treadonly: false,\r\n\t\tmediaType: 'image',\r\n\t\tsizeType: ['original', 'compressed'],\r\n\t\tsourceType: ['album', 'camera'],\r\n\t\tuploadIcon: 'camera',\r\n\t\tloadingText: '上传中...',\r\n\t\treloadText: '重新上传',\r\n\t\tfailedText: '上传失败',\r\n\t\tmode: 'grid'\r\n\t})\r\n\r\n\tconst isReadonly = computed(() : boolean => {\r\n\t\tconsole.log('isReadonly', props.readonly)\r\n\t\tif (props.readonly) return props.readonly;\r\n\t\treturn formReadonly?.value ?? false;\r\n\t})\r\n\tconst isDisabled = computed(() : boolean => {\r\n\t\tif (props.disabled) return props.disabled;\r\n\t\treturn formDisabled?.value ?? false;\r\n\t})\r\n\r\n\tconst transformFiles = (it : any) : UploadFile => {\r\n\r\n\t\tif (it instanceof UploadFile) {\r\n\t\t\treturn it\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\tconst file = UTSJSONObject.assign({}, it as UTSJSONObject) //it as UTSJSONObject\r\n\r\n\t\treturn {\r\n\t\t\turl: file.getString('url') ?? '',\r\n\t\t\tpath: file.getString('path'),\r\n\t\t\tname: file.getString('name'),\r\n\t\t\tthumb: file.getString('thumb'),\r\n\t\t\tsize: file.getNumber('size'),\r\n\t\t\ttype: file.getString('type'),\r\n\t\t\tpercent: file.getNumber('percent'),\r\n\t\t\tstatus: file.getString('status') ?? 'done',\r\n\t\t} as UploadFile\r\n\t}\r\n\tconst customFiles = ref<UploadFile[]>((props.modelValue ?? props.defaultFiles)?.map(transformFiles) ?? []);\r\n\r\n\tconst listWidth = ref(0);\r\n\tconst uploadRef = ref<UniElement | null>(null);\r\n\tconst styles = computed(() : Map<string, any> => {\r\n\t\tconst style = new Map<string, any>();\r\n\t\tconst gutter = unitConvert(props.gutter ?? 8) / 2 * -1\r\n\t\tstyle.set('margin-left', `${gutter}px`)\r\n\t\tstyle.set('margin-right', `${gutter}px`)\r\n\t\tstyle.set('margin-top', `${gutter}px`)\r\n\t\treturn style\r\n\t})\r\n\tconst itemStyle = computed(() : Map<string, any> => {\r\n\t\tconst style = new Map<string, any>();\r\n\r\n\t\t// const gridWidth = unitConvert(props.gridWidth ?? 80)\r\n\t\tconst gutter = unitConvert(props.gutter ?? 8) / 2\r\n\t\tlet column = props.column ?? 4;\r\n\r\n\t\tif (props.gridWidth != null || props.column != null) {\r\n\r\n\t\t\tconst width = listWidth.value / column - gutter * 2.0275;// ios 计算精度导致不均分\r\n\t\t\tstyle.set('width', props.gridWidth ?? `${width}px`)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t}\r\n\r\n\r\n\t\tif (props.gridHeight != null) {\r\n\t\t\tstyle.set('height', props.gridHeight!)\r\n\t\t}\r\n\t\tstyle.set('margin', `${gutter}px`)\r\n\t\tif (props.gridBgColor != null) {\r\n\t\t\tstyle.set('background', props.gridBgColor!)\r\n\t\t}\r\n\r\n\t\treturn style\r\n\t})\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tconst onFileClick = (index : number) => {\r\n\t\tconst file = customFiles.value[index]\r\n\t\temits('click', { file })\r\n\t}\r\n\tconst onProofTap = (index : number) => {\r\n\t\tonFileClick(index);\r\n\t\tif (props.disablePreview) return\r\n\t\tuni.previewImage({\r\n\t\t\turls: customFiles.value.filter((file) : boolean => file.percent != -1).map((file) : string => file.url),\r\n\t\t\tcurrent: index\r\n\t\t});\r\n\t}\r\n\tconst onDelete = (index : number) => {\r\n\t\tif (isDisabled.value || isReadonly.value) return;\r\n\t\tconst delFile = customFiles.value[index]\r\n\t\tcustomFiles.value = customFiles.value.filter((file, i) : boolean => index != i)\r\n\t\temits('remove', { index, file: delFile })\r\n\t}\r\n\r\n\tlet last : number// = 0\r\n\tconst upload = (files : UploadFile[]) => {\r\n\t\tif (!props.autoUpload || props.action == null || props.action!.length < 5) return\r\n\t\tif (props.action == 'uniCloud') {\r\n\t\t\tlet uploadImgs : Promise<UniCloudUploadFileResult>[] = [];\r\n\t\t\tfiles.forEach((file, index) => {\r\n\t\t\t\t// props.beforeRead(file).then((res)=>{})\r\n\r\n\t\t\t\tconst promise = new Promise<UniCloudUploadFileResult>((resolve, reject) => {\r\n\t\t\t\t\tconst dotIndex = file.name!.lastIndexOf('.'); // 找到最后一个点的位置\r\n\t\t\t\t\tconst baseName = file.name!.substring(0, dotIndex);\r\n\t\t\t\t\tconst extension = file.name!.substring(dotIndex);\r\n\t\t\t\t\tconst timestamp = Date.now();\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\tuniCloud.uploadFile({\r\n\t\t\t\t\t\tfilePath: file.url,\r\n\t\t\t\t\t\tcloudPath: `${baseName}_${timestamp}${extension}`,\r\n\t\t\t\t\t\t// cloudPath: file.name!.substring(file.name!.lastIndexOf('.')),\r\n\t\t\t\t\t\tonUploadProgress: (res) => {\r\n\t\t\t\t\t\t\tfile.status = 'loading'\r\n\t\t\t\t\t\t\tfile.percent = Math.floor(res.loaded / res.total * 100)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}).then(res => {\r\n\t\t\t\t\t\tfile.path = res.fileID;\r\n\t\t\t\t\t\tfile.status = 'done'\r\n\t\t\t\t\t\t// 获取临时URL\r\n\t\t\t\t\t\tuniCloud.getTempFileURL({\r\n\t\t\t\t\t\t\tfileList: [res.fileID]\r\n\t\t\t\t\t\t}).then(result => {\r\n\t\t\t\t\t\t\tif (result.fileList.length > 0) {\r\n\t\t\t\t\t\t\t\tfile.url = result.fileList[0].tempFileURL;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t\t}).catch(error => {\r\n\t\t\t\t\t\t\tconsole.error('获取临时URL失败', error);\r\n\t\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// resolve(res)\r\n\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\tfile.status = 'failed'\r\n\t\t\t\t\t\treject(err)\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\tuploadImgs.push(promise as Promise<UniCloudUploadFileResult>)\r\n\t\t\t})\r\n\r\n\t\t\tPromise.all(uploadImgs).then(res => {\r\n\t\t\t\temits('success', res)\r\n\t\t\t}).catch(err => {\r\n\t\t\t\temits('fail', err)\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tlet uploadImgs : Promise<UploadFileSuccess>[] = [];\r\n\t\t\tfiles.forEach((file, index) => {\r\n\t\t\t\tconst promise = new Promise<UploadFileSuccess>((resolve, reject) => {\r\n\t\t\t\t\tconst task = uni.uploadFile({\r\n\t\t\t\t\t\turl: props.action!,\r\n\t\t\t\t\t\tfilePath: file.url,\r\n\t\t\t\t\t\tname: file.name,\r\n\t\t\t\t\t\tformData: props.formData,\r\n\t\t\t\t\t\theader: props.headers,\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tfile.status = 'done'\r\n\t\t\t\t\t\t\tif (res.statusCode == 200) {\r\n\t\t\t\t\t\t\t\tif (typeof res.data == 'string') {\r\n\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\tconst data = JSON.parse<UTSJSONObject>(res.data);\r\n\t\t\t\t\t\t\t\t\t\tconst url = data?.getString('url');\r\n\t\t\t\t\t\t\t\t\t\tif (url != null) {\r\n\t\t\t\t\t\t\t\t\t\t\tfile.path = url\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\t\t//TODO handle the exception\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tresolve(res)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\tfile.status = 'failed'\r\n\t\t\t\t\t\t\treject(err)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\ttask.onProgressUpdate((res) => {\r\n\t\t\t\t\t\tfile.status = 'loading'\r\n\t\t\t\t\t\tfile.percent = res.progress\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\tuploadImgs.push(promise as Promise<UploadFileSuccess>)\r\n\t\t\t})\r\n\t\t\tPromise.all(uploadImgs).then(res => {\r\n\t\t\t\temits('success', res)\r\n\t\t\t}).catch(err => {\r\n\t\t\t\temits('fail', err)\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst customLimit = computed(() : number => props.max == 0 ? 20 : props.max - customFiles.value.length)\r\n\tconst onAddTap = () => {\r\n\t\tif (isDisabled.value || isReadonly.value) return;\r\n\t\tchooseFiles({\r\n\t\t\tmediaType: props.mediaType,\r\n\t\t\tcount: customLimit.value,\r\n\t\t\tsourceType: props.sourceType,\r\n\t\t\tsizeType: props.sizeType,\r\n\t\t\tsizeLimit: props.sizeLimit\r\n\t\t} as ChooseFileOptions).then((files) => {\r\n\t\t\tlast = customFiles.value.length\r\n\t\t\tcustomFiles.value = customFiles.value.concat(files)\r\n\t\t\t// @ts-ignore\r\n\t\t\tconst _files = customFiles.value.filter((it, i) : boolean => i > last - 1)\r\n\t\t\tupload(_files)\r\n\t\t\temits('add', _files)\r\n\t\t})\r\n\t}\r\n\r\n\r\n\r\n\r\n\tconst stop = watch(customFiles, (v : UploadFile[]) => {\r\n\t\temits('update:modelValue', v)\r\n\t})\r\n\r\n\tconst stopValue = watch(() : (UTSJSONObject[] | null) => props.modelValue, (v : UTSJSONObject[] | null) => {\r\n\t\tif (v != null && v.length != customFiles.value.length) {\r\n\t\t\tcustomFiles.value = v.map(transformFiles)\r\n\t\t}\r\n\t})\r\n\r\n\tdefineExpose({\r\n\t\tremove: onDelete\r\n\t})\r\n\r\n\r\n\tconst resizeObserver = new UniResizeObserver((entries : Array<UniResizeObserverEntry>) => {\r\n\t\tlistWidth.value = entries[0].target.getBoundingClientRect().width\r\n\t})\r\n\r\n\tonMounted(() => {\r\n\t\tnextTick(() => {\r\n\t\t\tlistWidth.value = uploadRef.value?.getBoundingClientRect().width ?? 0;\r\n\t\t\tresizeObserver.observe(uploadRef.value!)\r\n\t\t})\r\n\t})\r\n\r\n\r\n\tonUnmounted(() => {\r\n\t\tstop()\r\n\r\n\t\tresizeObserver.disconnect()\r\n\r\n\t})\r\n</script>\r\n<style lang=\"scss\">\r\n\t@import './index';\r\n</style>"]}