{"version":3,"file":"systemSetting.js","sources":["pages/mine/systemSetting/systemSetting.uvue","pages/mine/systemSetting/systemSetting.uvue?type=page"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<view class=\"content\">\n\t\t\t<view class=\"items underline\">\n\t\t\t\t<view class=\"offline\">\n\t\t\t\t\t<text>离线提醒</text>\n\t\t\t\t\t<fui-switch :checked= \"checked\" @change=\"changeChecked\" @update:checked=\"isChecked\"></fui-switch>\n\t\t\t\t</view>\n\t\t\t\t<text class=\"tips\">设备离线8小时后,推送消息到APP</text>\n\t\t\t</view>\n\t\t\t<view class=\"items\">\n\t\t\t\t<fui-input label=\"自动播放\" :labelSize=\"28\" textAlign=\"right\" :borderBottom=\"false\"\n\t\t\t\t\tplaceholderStyle=\"font-size: 28rpx;\" :disabled=\"true\" :placeholder = \"playTypeItem\" @click=\"playType\">\n\t\t\t\t\t<text>\n\t\t\t\t\t\t<fui-icon name=\"arrowright\" :size=\"48\"></fui-icon>\n\t\t\t\t\t</text>\n\t\t\t\t</fui-input>\n\t\t\t\t<text class=\"tips\">摄像机视频是否自动播放</text>\n\t\t\t</view>\n\t\t</view>\n\t\t<view class=\"content\">\n\t\t\t<view v-for=\"(item,index) in permissionList\" :key=\"index\">\n\t\t\t\t<fui-input :label=\"item.name\" :labelSize=\"28\" textAlign=\"right\" :borderBottom=\"true\"\n\t\t\t\t\t:placeholderStyle=\"item.status == '未授权' ? 'font-size: 28rpx;color:red;' : 'font-size: 28rpx;color:green;'\" :disabled=\"true\" :placeholder = \"item.status\" @click=\"getSystemAuth(item)\">\n\t\t\t\t\t<text>\n\t\t\t\t\t\t<fui-icon name=\"arrowright\" :size=\"48\"></fui-icon>\n\t\t\t\t\t</text>\n\t\t\t\t</fui-input>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<fui-bottom-popup :visible=\"showPicker\">\n\t\t\t<l-picker cancel-btn=\"取消\" confirm-btn=\"确定\" :columns=\"pickerOptions\" @cancel=\"oncancel\" @confirm=\"onConfirm\">\n\t\t\t</l-picker>\n\t\t</fui-bottom-popup>\n\t</view>\n</template>\n\n<script setup lang=\"uts\">\n\timport { ref } from 'vue'\n\timport { PickerColumn ,PickerConfirmEvent} from '@/uni_modules/lime-picker';\n\tconst checked = ref<boolean>(true)\n\tconst showPicker = ref<boolean>(false)\n\tconst pickerOptions = ref<PickerColumn[]>([])\n\tconst playTypeItem = ref<string>('WIFI下自动播放')\n\tconst systemNotifyState = ref<string>('')\n\n\t//授权类型\n\ttype AuthType = {\n\t\tcode:string\n\t\tstate: string\n\t}\n\n\tconst AuthState = ref<AuthType[]>([\n\t\t{\n\t\t\tcode:'authorized',\n\t\t\tstate: '已授权',\n\t\t},\n\t\t{\n\t\t\tcode:'not determined',\n\t\t\tstate: '未授权',\n\t\t},\n\t\t{\n\t\t\tcode:'denied',\n\t\t\tstate: '未授权',\n\t\t},\n\t])\n\n\t// 权限项类型\n\ttype PermissionItem = {\n\t\tname: string\n\t\tcode: string\n\t\tstatus: string\n\t}\n\n\t// 权限列表数据\n\tconst permissionList = ref<PermissionItem[]>([\n\t\t{ name: '位置信息', code: 'locationAuthorized', status: 'notDetermined' },\n\t\t{ name: '相册', code: 'albumAuthorized', status: 'notDetermined' },\n\t\t{ name: '麦克风', code: 'microphoneAuthorized', status: 'notDetermined' },\n\t\t{ name: '蓝牙', code: 'bluetoothAuthorized', status: 'notDetermined' },\n\t\t{ name: '系统通知', code: 'notificationAuthorized', status: 'notDetermined' },\n\t\t{ name: '相机', code: 'cameraAuthorized', status: 'notDetermined' },\n\t])\n\n\tconst getSystemAuth = (item:PermissionItem) => {\n\t\tconst res = uni.getAppAuthorizeSetting();\n\t\tconst code = item.code\n\t\tif(code == 'bluetoothAuthorized'){\n\t\t\tconst resu = uni.getSystemSetting();\n\t\t\tuni.__f__('log','at pages/mine/systemSetting/systemSetting.uvue:91',resu)\n\t\t\tif(resu.bluetoothEnabled == false){\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '请先手动打开蓝牙',\n\t\t\t\t})\n\t\t\t}else{\n\t\t\t\tpermissionList.value.map(item => {\n\t\t\t\t\tif(item.code == 'bluetoothAuthorized'){\n\t\t\t\t\t\titem.status = '已授权'\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}else{\n\t\t\tconst status = res[code]\n\t\t\tif(status == 'denied' || status == \"not determined\"){\n\t\t\t\tuni.openAppAuthorizeSetting({\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tuni.__f__('log','at pages/mine/systemSetting/systemSetting.uvue:108',res)\n\t\t\t\t\t\t// item.status = '已授权' \n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\n\n\tconst changeChecked = () => {\n\t\tuni.__f__('log','at pages/mine/systemSetting/systemSetting.uvue:119',checked.value)\n\t}\n\n\tconst isChecked = () => {\n\t\tchecked.value = !checked.value\n\t}\n\n\tconst getSystemNotify = () => {\n\t\tconst res = uni.getAppAuthorizeSetting();\n\t\tuni.__f__('log','at pages/mine/systemSetting/systemSetting.uvue:128',res.notificationAuthorized)\n\t\tif(res.notificationAuthorized == 'denied' || res.notificationAuthorized == \"not determined\"){\n\t\t\tuni.showToast({\n\t\t\t\ttitle: '请先授权通知权限',\n\t\t\t})\n\t\t\tuni.openAppAuthorizeSetting({\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tuni.__f__('log','at pages/mine/systemSetting/systemSetting.uvue:135',res)\n\t\t\t\t\tsystemNotifyState.value = '已授权'\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tconst playType = () => {\n\t\tpickerOptions.value = [\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tlabel: 'WIFI下自动播放',\n\t\t\t\t\tvalue: 'WIFI下自动播放',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: '总是播放',\n\t\t\t\t\tvalue: '总是播放',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: '不播放',\n\t\t\t\t\tvalue: '不播放',\n\t\t\t\t}\n\t\t\t]\n\t\t]  as PickerColumn[]\n\t\tshowPicker.value = true\n\t}\n\n\tconst onConfirm = (context : PickerConfirmEvent) => {\n\t\tshowPicker.value = false\n\t\tplayTypeItem.value = context.values[0].toString()\n\t}\n\n\tconst oncancel = () => {\n\t\tshowPicker.value = false\n\t}\n\n\tonPageShow(() => {\n    const res = uni.getAppAuthorizeSetting();\n    const resu = uni.getSystemSetting();\n    \n    permissionList.value = permissionList.value.map(item => {\n        const newItem = {...item} as PermissionItem;\n        if (item.code == 'bluetoothAuthorized' && resu.bluetoothEnabled == true) {\n            newItem.status = '已授权';\n        } else {\n            AuthState.value.forEach((auth) => {\n                if (auth.code === res[item.code]) {\n                    newItem.status = auth.state;\n                }\n            });\n        }\n        \n        return newItem;\n    });\n})\n\n\t// onLoad(()=>{\n\t// \tconst res = uni.getAppAuthorizeSetting();\n\t// \tuni.__f__('log','at pages/mine/systemSetting/systemSetting.uvue:193',res)\n\t// })\n</script>\n\n<style lang=\"scss\" scoped>\n\t.container{\n\t\theight: 100%;\n\t\tbackground-color: #f5f5f5;\n\t\tpadding: 20rpx;\n\t\t.content{\n\t\t\tbackground-color: #fff;\n\t\t\tpadding: 20rpx;\n\t\t\tborder-radius: 20rpx;\n\t\t\tmargin-bottom: 20rpx;\n\t\t\t.items{\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: column;\n\t\t\t\tpadding: 20rpx;\n\t\t\t\t.fui-input__wrap{\n\t\t\t\t\tpadding: 20rpx 0 !important;\n\t\t\t\t}\n\t\t\t\t.offline{\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-direction: row;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: space-between;\n\t\t\t\t\tpadding-bottom: 10rpx;\n\t\t\t\t}\n\t\t\t\t.tips{\n\t\t\t\t\t\tcolor:#999;\n\t\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\t}\n\t\t\t}\n\t\t\t.underline{\n\t\t\t\tborder-bottom: 1rpx solid #f5f5f5;\n\t\t\t}\n\t\t}\n\t\t\n\t\t.l-picker{\n\t\t\twidth:100%\n\t\t}\n\t}\t\n</style>\n","import MiniProgramPage from '/Users/xyhc/Documents/veepai_uniappx/pages/mine/systemSetting/systemSetting.uvue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","item","res","onPageShow"],"mappings":"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"}