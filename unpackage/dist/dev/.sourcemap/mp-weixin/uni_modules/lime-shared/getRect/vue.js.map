{"version":3,"file":"vue.js","sources":["uni_modules/lime-shared/getRect/vue.ts"],"sourcesContent":["// @ts-nocheck\r\n\r\n// #ifdef APP-NVUE\r\n// 当编译环境是 APP-NVUE 时，引入 uni.requireNativePlugin('dom')，具体插件用途未知\r\nconst dom = uni.requireNativePlugin('dom')\r\n// #endif\r\n\r\n/** \r\n * 获取节点信息\r\n * @param selector 选择器字符串\r\n * @param context ComponentInternalInstance 对象\r\n * @param node 是否获取node\r\n * @returns 包含节点信息的 Promise 对象\r\n */\r\nexport function getRect(selector : string, context : ComponentInternalInstance|ComponentPublicInstance, node: boolean = false) {\r\n\t// 之前是个对象，现在改成实例，防止旧版会报错\r\n\tif(context== null) {\r\n\t\treturn Promise.reject('context is null')\r\n\t}\r\n\tif(context.context){\r\n\t\tcontext = context.context\r\n\t}\r\n\t// #ifdef MP || VUE2\r\n\tif (context.proxy) context = context.proxy\r\n\t// #endif\r\n\treturn new Promise<UniNamespace.NodeInfo>((resolve, reject) => {\r\n\t\t// #ifndef APP-NVUE\r\n\t\tconst dom = uni.createSelectorQuery().in(context).select(selector);\r\n\t\tconst result = (rect: UniNamespace.NodeInfo) => {\r\n\t\t\tif (rect) {\r\n\t\t\t\tresolve(rect)\r\n\t\t\t} else {\r\n\t\t\t\treject('no rect')\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (!node) {\r\n\t\t\tdom.boundingClientRect(result).exec()\r\n\t\t} else {\r\n\t\t\tdom.fields({\r\n\t\t\t\tnode: true,\r\n\t\t\t\tsize: true,\r\n\t\t\t\trect: true\r\n\t\t\t}, result).exec()\r\n\t\t}\r\n\t\t// #endif\r\n\t\t// #ifdef APP-NVUE\r\n\t\tconst refs = context.refs || context.$refs\r\n\t\tif (/#|\\./.test(selector) && refs) {\r\n\t\t\tselector = selector.replace(/#|\\./, '')\r\n\t\t\tif (refs[selector]) {\r\n\t\t\t\tselector = refs[selector]\r\n\t\t\t\tif(Array.isArray(selector)) {\r\n\t\t\t\t\tselector = selector[0]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tdom.getComponentRect(selector, (res) => {\r\n\t\t\tif (res.size) {\r\n\t\t\t\tresolve(res.size)\r\n\t\t\t} else {\r\n\t\t\t\treject('no rect')\r\n\t\t\t}\r\n\t\t})\r\n\t\t// #endif\r\n\t});\r\n};\r\n\r\n\r\nexport function getAllRect(selector : string, context: ComponentInternalInstance|ComponentPublicInstance, node:boolean = false) {\r\n\tif(context== null) {\r\n\t\treturn Promise.reject('context is null')\r\n\t}\r\n\t// #ifdef MP || VUE2\r\n\tif (context.proxy) context = context.proxy\r\n\t// #endif\r\n\treturn new Promise<UniNamespace.NodeInfo>((resolve, reject) => {\r\n\t\t// #ifndef APP-NVUE\r\n\t\tconst dom = uni.createSelectorQuery().in(context).selectAll(selector);\r\n\t\tconst result = (rect: UniNamespace.NodeInfo[]) => {\r\n\t\t\tif (rect) {\r\n\t\t\t\tresolve(rect)\r\n\t\t\t} else {\r\n\t\t\t\treject('no rect')\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!node) {\r\n\t\t\tdom.boundingClientRect(result).exec()\r\n\t\t} else {\r\n\t\t\tdom.fields({\r\n\t\t\t\tnode: true,\r\n\t\t\t\tsize: true,\r\n\t\t\t\trect: true\r\n\t\t\t}, result).exec()\r\n\t\t}\r\n\t\t// #endif\r\n\t\t// #ifdef APP-NVUE\r\n\t\tlet { context } = options\r\n\t\tif (/#|\\./.test(selector) && context.refs) {\r\n\t\t\tselector = selector.replace(/#|\\./, '')\r\n\t\t\tif (context.refs[selector]) {\r\n\t\t\t\tselector = context.refs[selector]\r\n\t\t\t\tif(Array.isArray(selector)) {\r\n\t\t\t\t\tselector = selector[0]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tdom.getComponentRect(selector, (res) => {\r\n\t\t\tif (res.size) {\r\n\t\t\t\tresolve([res.size])\r\n\t\t\t} else {\r\n\t\t\t\treject('no rect')\r\n\t\t\t}\r\n\t\t})\r\n\t\t// #endif\r\n\t});\r\n};"],"names":["uni"],"mappings":";;AAcM,SAAU,QAAQ,UAAmB,SAA6D,OAAgB,OAAK;AAE5H,MAAG,WAAU,MAAM;AAClB,WAAO,QAAQ,OAAO,iBAAiB;AAAA,EACvC;AACD,MAAG,QAAQ,SAAQ;AAClB,cAAU,QAAQ;AAAA,EAClB;AAED,MAAI,QAAQ;AAAO,cAAU,QAAQ;AAErC,SAAO,IAAI,QAA+B,CAAC,SAAS,WAAM;AAEzD,UAAM,MAAMA,cAAG,MAAC,oBAAqB,EAAC,GAAG,OAAO,EAAE,OAAO,QAAQ;AACjE,UAAM,SAAS,CAAC,SAA2B;AAC1C,UAAI,MAAM;AACT,gBAAQ,IAAI;AAAA,MACZ,OAAM;AACN,eAAO,SAAS;AAAA,MAChB;AAAA,IACF;AAEA,QAAI,CAAC,MAAM;AACV,UAAI,mBAAmB,MAAM,EAAE,KAAI;AAAA,IACnC,OAAM;AACN,UAAI,OAAO;AAAA,QACV,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,MACN,GAAE,MAAM,EAAE;IACX;AAAA,EAqBF,CAAC;AACF;AAGM,SAAU,WAAW,UAAmB,SAA4D,OAAe,OAAK;AAC7H,MAAG,WAAU,MAAM;AAClB,WAAO,QAAQ,OAAO,iBAAiB;AAAA,EACvC;AAED,MAAI,QAAQ;AAAO,cAAU,QAAQ;AAErC,SAAO,IAAI,QAA+B,CAAC,SAAS,WAAM;AAEzD,UAAM,MAAMA,cAAG,MAAC,oBAAqB,EAAC,GAAG,OAAO,EAAE,UAAU,QAAQ;AACpE,UAAM,SAAS,CAAC,SAA6B;AAC5C,UAAI,MAAM;AACT,gBAAQ,IAAI;AAAA,MACZ,OAAM;AACN,eAAO,SAAS;AAAA,MAChB;AAAA,IACF;AACA,QAAI,CAAC,MAAM;AACV,UAAI,mBAAmB,MAAM,EAAE,KAAI;AAAA,IACnC,OAAM;AACN,UAAI,OAAO;AAAA,QACV,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,MACN,GAAE,MAAM,EAAE;IACX;AAAA,EAqBF,CAAC;AACF;;;"}