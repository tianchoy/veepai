{"version":3,"file":"l-picker-item.js","sources":["uni_modules/lime-picker/components/l-picker-item/l-picker-item.uvue","/Users/xyhc/Documents/veepai_uniappx/uni_modules/lime-picker/components/l-picker-item/l-picker-item.uvue?type=component"],"sourcesContent":["<template>\r\n\t<picker-view \r\n\t\tclass=\"l-picker-item__group\"\r\n\t\t:style=\"{opacity: options.length > 0 ? 1 : 0}\"\r\n\t\t:indicator-style=\"indicatorStyles\" \r\n\t\t:value=\"innerIndex\" \r\n\t\t@change=\"handlePick\"\r\n\t\tindicator-class=\"l-picker-item__indicator\">\r\n\t\t<picker-view-column class=\"l-picker-item__wrapper\">\r\n\r\n\r\n\r\n\r\n\t\t\t<text class=\"l-picker-item__group-item\" v-for=\"(item, i) in options\"\r\n\t\t\t\t:style=\"[itemStyles, curIndex == i ? itemActiveStyles: {}]\"\r\n\t\t\t\t:class=\"{'l-picker-item__group-item--active': curIndex == i}\" :key=\"item.value\">{{item.label}}</text>\r\n\r\n\t\t</picker-view-column>\r\n\t</picker-view>\r\n</template>\r\n<script lang=\"uts\" setup>\r\n\t/**\r\n\t * PickerItem 选择器子项组件\r\n\t * @description 用于构建多列选择器的单个列项，通常作为 Picker 组件的子组件使用\r\n\t * <br>插件类型：LPickerItemComponentPublicInstance \r\n\t * @tutorial https://ext.dcloud.net.cn/plugin?name=lime-picker\r\n\t * \r\n\t * @property {PickerColumnItem[]} options 当前列的选项列表（必填）\r\n\t * @property {PickerValue} value 当前选中值\r\n\t * @property {number} column 列索引标识（从0开始计数）\r\n\t * @property {string | number} name 列名称标识符\r\n\t */\r\n\timport { unitConvert } from '@/uni_modules/lime-shared/unitConvert'\r\n\timport { clamp } from '@/uni_modules/lime-shared/clamp'\r\n\timport { PickerItemProps, ManageChildInList, OnPick, UpdateItems } from './type';\r\n\timport { PickerColumnItem, PickerValue } from '../l-picker/type';\r\n\tconst instance = getCurrentInstance()!;\r\n\tconst props = withDefaults(defineProps<PickerItemProps>(), {\r\n\t\toptions: [] as PickerColumnItem[],\r\n\t\tcolumn: -1,\r\n\t\tresetIndex: false\r\n\t})\r\n\tconst picker = inject<LPickerComponentPublicInstance | null>('limePicker', null);\r\n\tconst pickerItemInstanceArray = inject<LPickerItemComponentPublicInstance[] | null>('limePickerItems', null);\r\n\tconst manageChildInList = inject<ManageChildInList | null>('limePickerManageChildInList', null);\r\n\tmanageChildInList?.(instance.proxy! as LPickerItemComponentPublicInstance, true)\r\n\tconst onPick = inject<OnPick | null>('limePickerOnPick', null);\r\n\tconst updateItems = inject<UpdateItems | null>('limePickerUpdateItems', null);\r\n\t// web 如果初始是0 当数据加载后 无法指向0\r\n\r\n\r\n\r\n\r\n\tconst curIndex = ref(0)\r\n\r\n\tconst curValue = ref<PickerValue | null>(props.value);\r\n\tconst column = computed(() : number => props.column != -1 ? props.column : pickerItemInstanceArray?.indexOf(instance.proxy! as LPickerItemComponentPublicInstance) ?? props.column);\r\n\r\n\tconst elementPosition = computed(() : boolean[] => {\r\n\t\tconst totalElements = pickerItemInstanceArray?.length ?? 0;\r\n\t\treturn [column.value == 0, column.value == totalElements - 1]\r\n\t});\r\n\tconst innerIndex = computed(() : number[] => [curIndex.value])\r\n\tconst indicatorStyles = computed(() : string => {\r\n\t\tconst [isFirst, isLast] = elementPosition.value\r\n\t\tlet style = ``\r\n\t\t\r\n\t\tif(isFirst) {\r\n\t\t\tstyle+= 'border-top-left-radius:12rpx; border-bottom-left-radius:12rpx;'\r\n\t\t}\r\n\t\tif(isLast) {\r\n\t\t\tstyle+= 'border-top-right-radius:12rpx; border-bottom-right-radius:12rpx;'\r\n\t\t}\r\n\t\treturn `\r\n\t\t\t${style}\r\n\t\t\theight: ${picker?.itemHeight ?? '50px'};\r\n\t\t\tbackground-color: rgba(0, 0, 0, 0.04); ${picker?.indicatorStyle}`\r\n\t})\r\n\tconst itemStyles = computed(() : Map<string, any> => {\r\n\t\tconst style = new Map<string, any>();\r\n\t\tif (picker?.itemColor != null) {\r\n\t\t\tstyle.set('color', picker.itemColor!)\r\n\t\t}\r\n\t\tif (picker?.itemFontSize != null) {\r\n\t\t\tstyle.set('font-size', picker.itemFontSize!)\r\n\t\t}\r\n\t\tif(picker?.itemHeight != null) {\r\n\t\t\tstyle.set('line-height', picker.itemHeight!)\r\n\t\t\tstyle.set('height', picker.itemHeight!)\r\n\t\t}\r\n\t\treturn style\r\n\t})\r\n\tconst itemActiveStyles = computed(() : Map<string, any> => {\r\n\t\tconst style = new Map<string, any>();\r\n\t\tif (picker?.itemActiveColor != null) {\r\n\t\t\tstyle.set('color', picker.itemActiveColor!)\r\n\t\t}\r\n\t\tif (picker?.itemActiveFontWeight != null) {\r\n\t\t\tstyle.set('font-weight', picker.itemActiveFontWeight!)\r\n\t\t}\r\n\t\treturn style\r\n\t})\r\n\r\n\r\n\tconst getIndexByValue = (val : PickerValue | null) => {\r\n\t\tlet defaultIndex = 0;\r\n\t\tif (val != null) {\r\n\t\t\tdefaultIndex = props.options.findIndex((item) => item.value == val);\r\n\t\t}\r\n\t\treturn defaultIndex < 0 ? 0 : defaultIndex;\r\n\t};\r\n\r\n\tconst setIndex = (index : number) => {\r\n\t\tlet lastIndex = curIndex.value\r\n\t\tlet _index = clamp(index, 0,  props.options.length - 1)\r\n\t\tif(props.options.length > _index) {\r\n\t\t\tcurIndex.value = _index;\r\n\t\t\tcurValue.value = props.options[_index].value\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t\r\n\t}\r\n\tconst setValue = (value : PickerValue | null) => {\r\n\t\tif (value == curValue.value) return\r\n\t\tcurValue.value = value\r\n\t\tconst index = getIndexByValue(value)\r\n\t\tsetIndex(index)\r\n\t}\r\n\tconst setOptions = () => { }\r\n\tconst setUpdateItems = () => {\r\n\t\tconst index = clamp(curIndex.value, 0,  props.options.length - 1)\r\n\t\tconst curItem = props.options.length > index ? props.options[index] : null;\r\n\t\tif (curItem == null) return\r\n\t\tupdateItems?.(curItem, index, column.value);\r\n\t}\r\n\t\r\n\tconst handlePick = (e : UniPickerViewChangeEvent) => {\r\n\t\tif(props.options.length == 0) return\r\n\t\tconst index = clamp(e.detail.value[0], 0,  props.options.length - 1);\r\n\t\tconst curItem = props.options[index];\r\n\t\tif(index == curIndex.value) return\r\n\t\tsetIndex(index)\r\n\t\tonPick?.(curItem, index, column.value);\r\n\t}\r\n\r\n\tconst stopValue = watch(() : PickerValue | null => props.value, (v : PickerValue | null) => {\r\n\t\tsetValue(v);\r\n\t\tsetUpdateItems();\r\n\t}, { immediate: true })\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tonBeforeUnmount(() => {\r\n\t\tmanageChildInList?.(instance.proxy! as LPickerItemComponentPublicInstance, false)\r\n\t\t\r\n\r\n\r\n\r\n\r\n\r\n\t})\r\n\t// onMounted(()=>{\r\n\t// \tif(props.options.length > 0 && curIndex.value == -1) {\r\n\t// \t\tcurIndex.value = 0\r\n\t// \t}\r\n\t// })\r\n\tdefineExpose({\r\n\t\tsetIndex,\r\n\t\tsetValue,\r\n\t\t// setOptions,\r\n\t\t// setUpdateItems,\r\n\t\tgetIndexByValue\r\n\t})\r\n</script>\r\n<style lang=\"scss\">\r\n\t@import './index';\r\n</style>","import Component from '/Users/xyhc/Documents/veepai_uniappx/uni_modules/lime-picker/components/l-picker-item/l-picker-item.uvue'\nwx.createComponent(Component)"],"names":["getCurrentInstance","inject","ref","computed","_a","__read","clamp","watch","onBeforeUnmount","Component"],"mappings":"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"}