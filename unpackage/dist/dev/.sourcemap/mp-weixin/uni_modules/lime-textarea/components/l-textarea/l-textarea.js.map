{"version":3,"file":"l-textarea.js","sources":["uni_modules/lime-textarea/components/l-textarea/l-textarea.uvue","/Users/xyhc/Documents/veepai_uniappx/uni_modules/lime-textarea/components/l-textarea/l-textarea.uvue?type=component"],"sourcesContent":["<template>\n\t<view \n\t\tclass=\"l-textarea\" \n\t\tref=\"textareaRef\"\n\t\t:style=\"[styles, lStyle]\"\n\t\t:class=\"[\n\t\t\t'l-textarea--' + layout,\n\t\t\t// classic ? 'l-textarea--classic-' + status : '',\n\t\t\t{\n\t\t\t\t'l-textarea--classic': classic,\n\t\t\t\t'l-textarea--classic-disabled':  classic && isDisabled,\n\t\t\t\t'l-textarea--classic-focused':  classic && !isDisabled && innerFocused,\n\t\t\t\t'l-textarea--border': bordered && !classic\n\t\t\t}]\">\n\t\t<text \n\t\t\tclass=\"l-textarea__label\" \n\t\t\t:style=\"[labelStyle]\"\n\t\t\t:class=\"[\n\t\t\t\t'l-textarea__label--' + layout,\n\t\t\t]\"\n\t\t\tv-if=\"label != null || $slots['label'] != null\">\n\t\t\t<slot>{{label}}</slot>\n\t\t</text>\n\t\t<view class=\"l-textarea__wrapper\">\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t\t\t<textarea \n\t\t\t\tclass=\"l-textarea__wrapper-inner\"\n\t\t\t\t:style=\"[innerStyle]\"\n\t\t\t\t:class=\"{'is-disabled': isDisabled}\"\n\t\t\t\t:maxlength=\"maxlength\"\n\t\t\t\t:disabled=\"isDisabled || isReadonly\"\n\t\t\t\t:value=\"innerValue\"\n\t\t\t\t:auto-height=\"autosize\"\n\t\t\t\t:auto-focus=\"autofocus\"\n\t\t\t\t:fixed=\"fixed\"\n\t\t\t\t:focus=\"focus\"\n\t\t\t\t:cursor=\"cursor\"\n\t\t\t\t:cursor-spacing=\"cursorSpacing\"\n\t\t\t\t:adjust-position=\"adjustPosition\"\n\t\t\t\t:confirm-type=\"confirmType\"\n\t\t\t\t:confirm-hold=\"confirmHold\"\n\t\t\t\t:disable-default-padding=\"disableDefaultPadding\"\n\t\t\t\t:show-confirm-bar=\"showConfirmBar\"\n\t\t\t\t:selection-start=\"selectionStart\"\n\t\t\t\t:selection-end=\"selectionEnd\"\n\t\t\t\t:hold-keyboard=\"holdKeyboard\"\n\t\t\t\t@input=\"onInput\"\n\t\t\t\t@focus=\"onFocus\"\n\t\t\t\t@blur=\"onBlur\"\n\t\t\t\t@confirm=\"onConfirm\"\n\t\t\t\t@linechange=\"onLineChange\"\n\t\t\t\t@keyboardheightchange=\"onKeyboardHeightChange\">\n\t\t\t</textarea>\n\t\t\t<!-- 微信小程序 placeholder 不支持line-height 导致无法对齐，使用text模拟 -->\n\t\t\t<text class=\"l-textarea__placeholder\" :style=\"placeholderStyle\" v-if=\"innerValue.length == 0\">{{placeholder}}</text>\n\n\t\t\t\n\t\t\t<text class=\"l-textarea__indicator\" :style=\"[indicatorStyle]\" v-if=\"indicator && ((maxcharacter ?? maxlength) > 0 )\">{{count}} / {{maxcharacter ?? maxlength}}</text>\n\t\t</view>\n\t</view>\n</template>\n<script lang=\"uts\" setup>\n\t/**\n\t * Textarea 多行输入框组件\n\t * @description 用于多行文本输入场景，支持自适应高度和多种键盘控制选项\n\t * <br>插件类型：LTextareaComponentPublicInstance \n\t * @tutorial https://ext.dcloud.net.cn/plugin?name=lime-textarea\n\t * \n\t * @property {boolean} adjustPosition 键盘弹起自动上推页面（默认：true）\n\t * @property {boolean} autofocus 自动聚焦（默认：false）\n\t * @property {boolean} autosize 自动调整高度（默认：false）\n\t * @property {boolean} bordered 显示外边框（默认：true）\n\t * @property {boolean} confirmHold 点击确认保持键盘不收起（默认：false）\n\t * @property {'return' | 'send' | 'search' | 'next' | 'go' | 'done'} confirmType 键盘确认按钮类型（默认：\"done\"）\n\t * @value return\n\t * @value send\n\t * @value search\n\t * @value next\n\t * @value go\n\t * @value done\n\t * @property {number} cursor 聚焦时初始光标位置\n\t * @property {number} cursorSpacing 键盘与输入框间距（单位px，默认：0）\n\t * @property {boolean} disableDefaultPadding 禁用iOS默认内边距（默认：false）\n\t * @property {boolean} disabled 禁用状态（默认：false）\n\t * @property {boolean} readonly 只读（默认：false）\n\t * @property {boolean} classic 经典边框（默认：false）\n\t * @property {boolean} fixed 在fixed定位区域使用（默认：false）\n\t * @property {boolean} defaultFixed 默认fixed模式（兼容旧版）\n\t * @property {boolean} focus 自动聚焦（默认：false）\n\t * @property {boolean} focused 是否显示获焦样式，用于结合自定义键盘使用时显示高亮效果\n\t * @property {boolean} holdKeyboard 点击页面不收起键盘（默认：false）\n\t * @property {boolean} indicator 显示字数统计（默认：false）\n\t * @property {string} label 左侧标签文本\n\t * @property {number} maxcharacter 最大字符长度（中文算2个）\n\t * @property {number} maxlength 最大输入长度（默认：-1不限制）\n\t * @property {string} placeholder 占位文字\n\t * @property {number} selectionEnd 光标结束位置（需搭配selectionStart）\n\t * @property {number} selectionStart 光标起始位置（需搭配selectionEnd）\n\t * @property {boolean} showConfirmBar 显示键盘完成栏（默认：true）\n\t * @property {string} value 输入值（支持v-model）\n\t * @property {'vertical' | 'horizontal'} layout 标签布局方式（默认：\"horizontal\"）\n\t * @value vertical\n\t * @value horizontal\n\t * @property {string} placeholderStyle 占位文字样式（仅支持color/font-size/font-weight）\n\t * @property {string} lStyle 自定义组件样式（CSS字符串）\n\t * @property {string} labelStyle 标签样式（CSS字符串）\n\t * @property {string} indicatorStyle 字数统计样式（CSS字符串）\n\t * @property {string} innerStyle 输入区域样式（CSS字符串）\n\t * @property {string} borderColor 边框颜色\n\t * @property {string} focusedBorderColor 聚焦时边框颜色\n\t * @event {Function} focus 聚焦时触发\n\t * @event {Function} blur 失焦时触发\n\t * @event {Function} confirm 点击完成按钮触发\n\t * @event {Function} linechange 行数变化时触发\n\t * @event {Function} change \n\t * @event {Function} keyboardheightchange \n\t */\n\n\n\timport { TextareaProps } from './type';\n\timport { characterLimit, type CharacterLengthResult } from '@/uni_modules/lime-shared/characterLimit';\n\t\n\n\n\n\t\n\tconst emit = defineEmits(['change', 'focus', 'blur', 'confirm', 'linechange', 'keyboardheightchange'])\n\tconst props = withDefaults(defineProps<TextareaProps>(), {\n\t\tadjustPosition: true,\n\t\tautofocus: false,\n\t\tautosize: false,\n\t\tbordered: true,\n\t\tconfirmHold: false,\n\t\tconfirmType: 'return',\n\t\tcursor: -1,\n\t\tcursorSpacing: 0,\n\t\tdisableDefaultPadding: false,\n\t\tdisabled: false,\n\t\tfixed: false,\n\t\tdefaultFixed: false,\n\t\tfocus: false,\n\t\tholdKeyboard: false,\n\t\tindicator: false,\n\t\tmaxlength: -1,\n\t\tplaceholder: '',\n\t\tplaceholderStyle: '',\n\t\tselectionEnd:-1,\n\t\tselectionStart:-1,\n\t\tshowConfirmBar: true,\n\t\tlayout: 'horizontal',\n\t\tclassic: false,\n\t\treadonly: false,\n\t\tfocused: false\n\t})\n\t\n\tconst formItemBlur = inject<(() => void)|null>('formItemBlur', null);\n\tconst formDisabled = inject<Ref<boolean|null>|null>('formDisabled', null)\n\tconst formReadonly = inject<Ref<boolean|null>|null>('formReadonly', null)\n\t\n\tconst count = ref(0);\n\tconst innerFocused = ref(props.focus || props.focused);\n\t\n\tconst calculateValue = (value: string):CharacterLengthResult => {\n\t\tconst { maxlength, maxcharacter } = props;\n\t\tif(maxcharacter != null && maxcharacter > 0) {\n\t\t\treturn characterLimit('maxcharacter', value, maxcharacter)\n\t\t} else if(maxlength > 0) {\n\t\t\treturn characterLimit('maxlength', value, maxlength)\n\t\t}\n\t\treturn {\n\t\t\tcharacters: value,\n\t\t\tlength: value.length\n\t\t} as CharacterLengthResult\n\t}\n\tlet _innerValue = ''\n\tconst modelValue = defineModel({type: String, default: ''})\n\tconst innerValue = computed({\n\t\tset(v: string) {\n\t\t\t_innerValue = v;\n\t\t\tmodelValue.value = v;\n\t\t\temit('change', v)\n\t\t},\n\t\tget():string {\n\t\t\tconst _value = props.value ?? modelValue.value\n\t\t\tif(_innerValue != _value) {\n\t\t\t\tconst {characters, length} = calculateValue(props.value ?? modelValue.value);\n\t\t\t\tcount.value = length;\n\t\t\t\treturn characters\n\t\t\t}\n\t\t\treturn _value\n\t\t},\n\t} as WritableComputedOptions<string>)\n\t\n\tconst isReadonly= computed(():boolean=>{\n\t\tif (props.readonly) return props.readonly;\n\t\treturn formReadonly?.value ?? false;\n\t})\n\tconst isDisabled= computed(():boolean=>{\n\t\tif (props.disabled) return props.disabled;\n\t\treturn formDisabled?.value ?? false;\n\t})\n\t\n\t\n\tconst styles = computed(():Map<string, string>=> {\n\t\tconst style = new Map<string, string>()\n\n\t\tif(props.borderColor) {\n\t\t\tstyle.set('--l-textarea-border-color', props.borderColor)\n\t\t}\n\t\tif(props.focusedBorderColor) {\n\t\t\tstyle.set('--l-textarea-focused-border-color', props.focusedBorderColor)\n\t\t}\n\n\t\treturn style\n\t})\n\t\n\tconst onInput = (event: UniInputEvent) => {\n\t\tlet { value, cursor } = event.detail;\n\t\tconst {characters, length} = calculateValue(value);\n\t\tcount.value = length;\n\t\tinnerValue.value = characters;\n\t}\n\tconst onFocus = (event: UniTextareaFocusEvent) => {\n\t\tinnerFocused.value = true;\n\t\temit('focus', event)\n\t}\n\tconst onBlur = (event: UniTextareaBlurEvent) => {\n\t\tinnerFocused.value = false;\n\t\temit('blur', event)\n\t\tformItemBlur?.()\n\t}\n\tconst onConfirm = (event: UniInputConfirmEvent) => {\n\t\temit('confirm', event)\n\t}\n\tconst onLineChange = (event: UniTextareaLineChangeEvent) => {\n\t\temit('linechange', event)\n\t}\n\tconst onKeyboardHeightChange = (event: UniInputKeyboardHeightChangeEvent) => {\n\t\temit('keyboardheightchange', event)\n\t}\n\t\n\twatchEffect(()=> {\n\t\tinnerFocused.value = props.focus || props.focused;\n\t})\n\t\n\t\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t\n</script>\n<style lang=\"scss\">\n\t@import './index';\n</style>\n","import Component from '/Users/xyhc/Documents/veepai_uniappx/uni_modules/lime-textarea/components/l-textarea/l-textarea.uvue'\nwx.createComponent(Component)"],"names":["inject","ref","characterLimit","_useModel","computed","_a","watchEffect","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+JC,UAAM,OAAO;AACb,UAAM,QAAQ;AA4Bd,UAAM,eAAeA,cAAAA,OAA0B,gBAAgB,IAAI;AACnE,UAAM,eAAeA,cAAAA,OAA+B,gBAAgB,IAAI;AACxE,UAAM,eAAeA,cAAAA,OAA+B,gBAAgB,IAAI;AAExE,UAAM,QAAQC,kBAAI,CAAC;AACnB,UAAM,eAAeA,cAAAA,IAAI,MAAM,SAAS,MAAM,OAAO;AAErD,UAAM,iBAAiB,CAAC,UAAa;AAC5B,YAAA,YAA4B,MAAK,WAAtB,eAAiB,MAAK;AACzC,UAAG,gBAAgB,QAAQ,eAAe,GAAG;AAC5C,eAAOC,2DAAe,gBAAgB,OAAO,YAAY;AAAA,MACzD,WAAS,YAAY,GAAG;AACxB,eAAOA,2DAAe,aAAa,OAAO,SAAS;AAAA,MACnD;AACD,aAAO;AAAA,QACN,YAAY;AAAA,QACZ,QAAQ,MAAM;AAAA;IAEhB;AACA,QAAI,cAAc;AAClB,UAAM,aAAaC,cAAAA,SAAW,SAAA,YAA4B;AAC1D,UAAM,aAAaC,cAAAA,SAAS;AAAA,MAC3B,IAAI,GAAS;AACZ,sBAAc;AACd,mBAAW,QAAQ;AACnB,aAAK,UAAU,CAAC;AAAA,MAChB;AAAA,MACD,MAAG;;AACF,cAAM,UAASC,MAAA,MAAM,WAAS,QAAAA,QAAA,SAAAA,MAAA,WAAW;AACzC,YAAG,eAAe,QAAQ;AACnB,gBAAA,KAAuB,qBAAe,MAAM,WAAS,QAAA,OAAA,SAAA,KAAA,WAAW,KAAK,GAApE,4BAAY;AACnB,gBAAM,QAAQ;AACd,iBAAO;AAAA,QACP;AACD,eAAO;AAAA,MACP;AAAA,IACkC,CAAA;AAEpC,UAAM,aAAYD,cAAAA,SAAS,MAAA;;AAC1B,UAAI,MAAM;AAAU,eAAO,MAAM;AACjC,cAAOC,MAAA,iBAAY,QAAZ,iBAAY,SAAA,OAAZ,aAAc,WAAS,QAAAA,QAAA,SAAAA,MAAA;AAAA,IAC/B,CAAC;AACD,UAAM,aAAYD,cAAAA,SAAS,MAAA;;AAC1B,UAAI,MAAM;AAAU,eAAO,MAAM;AACjC,cAAOC,MAAA,iBAAY,QAAZ,iBAAY,SAAA,OAAZ,aAAc,WAAS,QAAAA,QAAA,SAAAA,MAAA;AAAA,IAC/B,CAAC;AAGD,UAAM,SAASD,cAAAA,SAAS,MAAA;AACvB,YAAM,QAAQ,oBAAI;AAElB,UAAG,MAAM,aAAa;AACrB,cAAM,IAAI,6BAA6B,MAAM,WAAW;AAAA,MACxD;AACD,UAAG,MAAM,oBAAoB;AAC5B,cAAM,IAAI,qCAAqC,MAAM,kBAAkB;AAAA,MACvE;AAED,aAAO;AAAA,IACR,CAAC;AAED,UAAM,UAAU,CAAC,UAAoB;AAChC,UAAAC,MAAoB,MAAM,QAAxB,QAAKA,IAAA;AAAQ,MAAAA,IAAA;AACb,YAAA,KAAuB,eAAe,KAAK,GAA1C,aAAU,GAAA,YAAE,SAAM,GAAA;AACzB,YAAM,QAAQ;AACd,iBAAW,QAAQ;AAAA,IACpB;AACA,UAAM,UAAU,CAAC,UAA4B;AAC5C,mBAAa,QAAQ;AACrB,WAAK,SAAS,KAAK;AAAA,IACpB;AACA,UAAM,SAAS,CAAC,UAA2B;AAC1C,mBAAa,QAAQ;AACrB,WAAK,QAAQ,KAAK;AAClB,uBAAA,QAAA,iBAAA,SAAA,OAAA;IACD;AACA,UAAM,YAAY,CAAC,UAA2B;AAC7C,WAAK,WAAW,KAAK;AAAA,IACtB;AACA,UAAM,eAAe,CAAC,UAAiC;AACtD,WAAK,cAAc,KAAK;AAAA,IACzB;AACA,UAAM,yBAAyB,CAAC,UAAwC;AACvE,WAAK,wBAAwB,KAAK;AAAA,IACnC;AAEAC,kBAAAA,YAAY,MAAA;AACX,mBAAa,QAAQ,MAAM,SAAS,MAAM;AAAA,IAC3C,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnRF,GAAG,gBAAgBC,SAAS;"}