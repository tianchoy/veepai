{"version":3,"file":"utils.js","sources":["uni_modules/lime-svg/components/l-svg/utils.ts"],"sourcesContent":["// @ts-nocheck\r\n// #ifdef APP-ANDROID || APP-IOS \r\nimport { fileToDataURL } from '@/uni_modules/lime-file-utils'\r\n// #endif\r\n\r\n\r\n/**\r\n * 小程序把路径转成base64\r\n * @param {string} path \r\n * @return 表示 SVG 的 Data URL。\r\n */\r\nexport function pathToDataUrl(path : string) : Promise<string> {\r\n\t\r\n\treturn new Promise((resolve, reject) => {\r\n\t\t// #ifdef MP\r\n\t\tuni.getFileSystemManager().readFile({\r\n\t\t\tfilePath: path,\r\n\t\t\tencoding: 'base64',\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t\tresolve(`data:image/svg+xml;base64,${res.data}`)\r\n\t\t\t},\r\n\t\t\tfail: (error) => {\r\n\t\t\t\tconsole.error({ error, path })\r\n\t\t\t\treject(error)\r\n\t\t\t}\r\n\t\t})\r\n\t\t// #endif\r\n\t\t// #ifdef APP-ANDROID || APP-IOS \r\n\t\tconst url = fileToDataURL(path)\r\n\t\tif(url == null) {\r\n\t\t\treject('路径错误')\r\n\t\t}\r\n\t\tresolve(url!.replace(/\\s+/g,''))\r\n\t\t// #endif\r\n\t\t// #ifdef APP-NVUE\r\n\t\tlet localFilePath = plus.io.convertAbsoluteFileSystem(path)\r\n\t\tif (localFilePath == path) {\r\n\t\t\tlocalFilePath = '_www/' + path.slice(1)\r\n\t\t}\r\n\t\tplus.io.resolveLocalFileSystemURL(localFilePath, (entry) => {\r\n\t\t\tentry.file((file : any) => {\r\n\t\t\t\tconst fileReader = new plus.io.FileReader()\r\n\t\t\t\tfileReader.onload = (data) => {\r\n\t\t\t\t\tresolve(data.target.result)\r\n\t\t\t\t}\r\n\t\t\t\tfileReader.onerror = (error) => {\r\n\t\t\t\t\tconsole.error({ error, path })\r\n\t\t\t\t\treject(error)\r\n\t\t\t\t}\r\n\t\t\t\tfileReader.readAsDataURL(file)\r\n\t\t\t}, reject)\r\n\t\t}, reject)\r\n\t\t// #endif\r\n\t\t// #ifndef APP-ANDROID || APP-IOS || MP || APP-NVUE\r\n\t\treject('不支持')\r\n\t\t// #endif\r\n\t})\r\n\r\n}\r\n\r\n/**\r\n * 将 SVG 字符串转换为 Data URL。\r\n * @param {string} svg - 要转换的 SVG 字符串。\r\n * @returns {string} 表示 SVG 的 Data URL。\r\n */\r\nexport function svgToDataUrl(svgString : string) : string {\r\n\tconst encodedSvg = encodeURIComponent(svgString)!.replace(/\\+/g, '%20');\r\n\treturn `data:image/svg+xml,${encodedSvg}`\r\n}"],"names":["uni"],"mappings":";;AAWM,SAAU,cAAc,MAAa;AAE1C,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAM;AAElCA,wBAAI,qBAAsB,EAAC,SAAS;AAAA,MACnC,UAAU;AAAA,MACV,UAAU;AAAA,MACV,SAAS,CAAC,QAAG;AACZ,gBAAQ,6BAA6B,IAAI,IAAI,EAAE;AAAA,MAC/C;AAAA,MACD,MAAM,CAAC,UAAK;AACXA,sBAAA,MAAA,MAAA,SAAA,wDAAc,EAAE,OAAO,KAAI,CAAE;AAC7B,eAAO,KAAK;AAAA,MACZ;AAAA,IACD,CAAA;AAAA,EA+BF,CAAC;AAEF;AAOM,SAAU,aAAa,WAAkB;AAC9C,QAAM,aAAa,mBAAmB,SAAS,EAAG,QAAQ,OAAO,KAAK;AACtE,SAAO,sBAAsB,UAAU;AACxC;;;"}