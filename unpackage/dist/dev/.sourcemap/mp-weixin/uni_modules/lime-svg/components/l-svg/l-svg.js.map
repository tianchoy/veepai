{"version":3,"file":"l-svg.js","sources":["uni_modules/lime-svg/components/l-svg/l-svg.uvue","/Users/xyhc/Documents/veepai_uniappx/uni_modules/lime-svg/components/l-svg/l-svg.uvue?type=component"],"sourcesContent":["<template>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t<view class=\"l-svg\" :class=\"{'is-inherit': isInherit}\" :style=\"styles\">\n\t\t<image class=\"l-svg-img\" :src=\"path\" @error=\"onError\" @load=\"onLoad\"></image>\n\t</view>\n\n</template>\n\n<script setup lang=\"uts\">\n\t/**\n\t * Svg SVG组件\n\t * @description 用于渲染SVG路径元素，支持动态颜色和继承属性\n\t * <br>插件类型：LSvpComponentPublicInstance \n\t * @tutorial https://ext.dcloud.net.cn/plugin?name=lime-svg\n\t * \n\t * @property {string} src SVG路径\n\t * @property {string} color 路径颜色（默认：\"currentColor\"）\n\t * @property {boolean} web 是否启用Web优化模式（默认：false）\n\t * @property {boolean} inherit 是否继承父级SVG属性（默认：true）\n\t * @event {Function} load SVG路径加载完成时触发\n\t * @event {Function} error SVG路径加载失败时触发\n\t */\n\t\n\timport { LSvpProps } from './type'\n\n\timport { pathToDataUrl, svgToDataUrl } from './utils'\n\n\n\n\n\n\n\n\n\n\n\tconst props = withDefaults(defineProps<LSvpProps>(), {\n\t\tsrc: '',\n\t\tcolor: '',\n\t\tweb: false,\n\t\tinherit: false\n\t})\n\t\n\tconst emit = defineEmits(['load', 'error'])\n\tconst path = ref(props.src)\n\tconst svgRef = ref<UniElement | null>(null)\n\n\tconst isInherit = computed(() : boolean => {\n\t\treturn props.color != ''\n\t})\n\n\t\n\t\n\tconst imageURL = ref('')\n\tconst formatUrl = (url : string, action : string) : string => {\n\t\tif (url.indexOf(`'`) > 0) return `${action}(\"${url}\")`\n\t\treturn `${action}('${url}')`\n\t}\n\tconst styles = computed(() : Map<string, string> => {\n\t\tconst style = new Map<string, string>()\n\n\n\n\n\n\n\n\t\tif (path.value != '') {\n\t\t\t// style.set('--svg', formatUrl(props.src, 'url'))\n\t\t\tstyle.set('--svg', formatUrl(path.value, 'url'))\n\t\t}\n\n\t\tif (props.color != '') {\n\t\t\tstyle.set('color', props.color)\n\t\t}\n\t\treturn style\n\t})\n\n\t\n\n\n\n\n\n\n\n\n\tconst errorDetaill = {\n\t\terrMsg: '加载失败'\n\t}\n\tconst errorEvent = {\n\t\ttype: 'error',\n\t\tdetaill: errorDetaill\n\t}\n\n\n\tconst onError = () => {\n\t\temit('error', errorEvent)\n\t}\n\tconst onLoad = (e : UniNativeViewEvent) => {\n\n\n\n\n\n\n\n\n\n\t\tconst detail = {\n\t\t\twidth: 512,\n\t\t\theight: 512\n\t\t}\n\t\tconst loadEvent = {\n\t\t\ttype: 'load',\n\t\t\tdetail\n\t\t}\n\n\t\temit('load', loadEvent)\n\t}\n\t// app\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t\n\n\t// 小程序\n\n\twatchEffect(() => {\n\t\tif (props.src == '') return\n\t\tif (props.src.startsWith('<svg')) {\n\t\t\tpath.value = svgToDataUrl(props.src)\n\t\t} else if (props.src.startsWith('/static')) {\n\t\t\tpathToDataUrl(props.src).then(res => {\n\t\t\t\tpath.value = res;\n\t\t\t}).catch(err => {\n\t\t\t\temit('error', errorEvent)\n\t\t\t\tuni.__f__('warn','at uni_modules/lime-svg/components/l-svg/l-svg.uvue:263',\"[lime-svg]\" + props.src + JSON.stringify(err))\n\t\t\t})\n\t\t} else {\n\t\t\tpath.value = props.src\n\t\t}\n\t})\n\n</script>\n\n<style lang=\"scss\">\n\t.l-svg {\n\t\t// align-self: flex-start;\n\n\n\n\n\n\t\twidth: 1em;\n\t\theight: 1em;\n\n\n\n\t\t:deep(svg) {\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t}\n\n\t\t&-img {\n\t\t\tmix-blend-mode: lighten;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t}\n\n\t\t&.is-inherit {\n\t\t\t-webkit-mask-image: var(--svg);\n\t\t\tmask-image: var(--svg);\n\t\t\t-webkit-mask-repeat: no-repeat;\n\t\t\tmask-repeat: no-repeat;\n\t\t\t-webkit-mask-size: 100% 100%;\n\t\t\tmask-size: 100% 100%;\n\t\t\tbackground-color: currentColor;\n\t\t}\n\n\t\t&:not(.is-inherit) {\n\t\t\tbackground: var(--svg) no-repeat;\n\t\t\tbackground-size: 100% 100%;\n\t\t\tbackground-color: transparent;\n\n\t\t\timage {\n\t\t\t\tmix-blend-mode: inherit;\n\t\t\t\topacity: 0;\n\t\t\t}\n\t\t}\n\n\n\t}\n</style>","import Component from '/Users/xyhc/Documents/veepai_uniappx/uni_modules/lime-svg/components/l-svg/l-svg.uvue'\nwx.createComponent(Component)"],"names":["ref","computed","watchEffect","svgToDataUrl","pathToDataUrl","uni","Component"],"mappings":";;;;;;;;;;;;;;AAoDC,UAAM,QAAQ;AAOd,UAAM,OAAO;AACb,UAAM,OAAOA,cAAAA,IAAI,MAAM,GAAG;AACXA,kBAAAA,IAAuB,IAAI;AAE1C,UAAM,YAAYC,cAAAA,SAAS,MAAA;AAC1B,aAAO,MAAM,SAAS;AAAA,IACvB,CAAC;AAIgBD,kBAAAA,IAAI,EAAE;AACvB,UAAM,YAAY,CAAC,KAAc,WAAe;AAC/C,UAAI,IAAI,QAAQ,GAAG,IAAI;AAAG,eAAO,GAAG,MAAM,KAAK,GAAG;AAClD,aAAO,GAAG,MAAM,KAAK,GAAG;AAAA,IACzB;AACA,UAAM,SAASC,cAAAA,SAAS,MAAA;AACvB,YAAM,QAAQ,oBAAI;AAQlB,UAAI,KAAK,SAAS,IAAI;AAErB,cAAM,IAAI,SAAS,UAAU,KAAK,OAAO,KAAK,CAAC;AAAA,MAC/C;AAED,UAAI,MAAM,SAAS,IAAI;AACtB,cAAM,IAAI,SAAS,MAAM,KAAK;AAAA,MAC9B;AACD,aAAO;AAAA,IACR,CAAC;AAWD,UAAM,eAAe,IAAA,cAAA;AAAA,MACpB,QAAQ;AAAA,IACR,CAAA;AACD,UAAM,aAAa,IAAA,cAAA;AAAA,MAClB,MAAM;AAAA,MACN,SAAS;AAAA,IACT,CAAA;AAGD,UAAM,UAAU,MAAA;AACf,WAAK,SAAS,UAAU;AAAA,IACzB;AACA,UAAM,SAAS,CAAC,MAAsB;AAUrC,YAAM,SAAS,IAAA,cAAA;AAAA,QACd,OAAO;AAAA,QACP,QAAQ;AAAA,MACR,CAAA;AACD,YAAM,YAAY,IAAA,cAAA;AAAA,QACjB,MAAM;AAAA,QACN;AAAA,MACA,CAAA;AAED,WAAK,QAAQ,SAAS;AAAA,IACvB;AAsHAC,kBAAAA,YAAY,MAAA;AACX,UAAI,MAAM,OAAO;AAAI,eAAM;AAC3B,UAAI,MAAM,IAAI,WAAW,MAAM,GAAG;AACjC,aAAK,QAAQC,0CAAAA,aAAa,MAAM,GAAG;AAAA,MACnC,WAAU,MAAM,IAAI,WAAW,SAAS,GAAG;AAC3CC,kDAAa,cAAC,MAAM,GAAG,EAAE,KAAK,CAAA,MAAG,SAAA;AAChC,eAAK,QAAQ;AAAA,QACb,CAAA,EAAE,MAAM,CAAA,MAAG,SAAA;AACX,eAAK,SAAS,UAAU;AACxBC,wBAAAA,MAAI,MAAM,QAAO,2DAA0D,eAAe,MAAM,MAAM,IAAK,KAAA,UAAU,GAAG,CAAC;AAAA,QAC1H,CAAC;AAAA,MACD,OAAM;AACN,aAAK,QAAQ,MAAM;AAAA,MACnB;AAAA,IACF,CAAC;;;;;;;;;;;;;;AC1QF,GAAG,gBAAgBC,SAAS;"}