{"version":3,"file":"l-daily-punch.js","sources":["uni_modules/lime-daily-punch/components/l-daily-punch/l-daily-punch.uvue","/Users/xyhc/Documents/veepai_uniappx/uni_modules/lime-daily-punch/components/l-daily-punch/l-daily-punch.uvue?type=component"],"sourcesContent":["<template>\n\t<view class=\"calender\">\n\t\t<canvas ref=\"dailyRef\" id=\"l-daily-punch\" class=\"l-daily-punch\" :style=\"[styles]\" @click=\"onClick\"></canvas>\n\t</view>\n</template>\n<script setup lang=\"uts\">\n\timport { Calendar} from './calender'\n\timport { PropType } from 'vue'\n\timport { unitConvert } from '@/uni_modules/lime-shared/unitConvert';\n\timport { LDay,  LOptions, LYearMonth } from '../../index';\n\tconst emits = defineEmits(['select', 'panelChange', 'streak'])\n\tconst props = defineProps({\n\t\tcanSupplement: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tisFullCalendar: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tyearMonth: {\n\t\t\ttype: String,\n\t\t\tdefault: () : string => {\n\t\t\t\tconst date = new Date();\n\t\t\t\tconst year = date.getFullYear();\n\t\t\t\tconst month = (date.getMonth() + 1).toString().padStart(2, '0'); // 确保月份是两位数\n\t\t\t\treturn `${year}-${month}`;\n\t\t\t}\n\t\t},\n\t\tsignedDates: {\n\t\t\ttype: Array as PropType<string[]>,\n\t\t\tdefault: () : string[] => {\n\t\t\t\treturn [] as string[];\n\t\t\t},\n\t\t\tvalidator: (value : string[]):boolean => {\n\t\t\t\t// 简单的验证函数，确保每个元素都是有效的日期字符串\n\t\t\t\treturn value.every((date : string) : boolean => /^\\d{4}-\\d{2}-\\d{2}$/.test(date));\n\t\t\t}\n\t\t},\n\n\n\n\n\n\n\n\t\tdayHeight: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: 76\n\t\t},\n\n\t\tweek: {\n\t\t\ttype: Array as PropType<string[]>,\n\t\t\tdefault: () : string[] => ['周日', '周一', '周二', '周三', '周四', '周五', '周六']\n\t\t},\n\t\tweekStartsOn: {\n\t\t\ttype: Number,\n\t\t\tdefault: 6,\n\t\t\tvalidator: (value:number):boolean => value <= 6\n\t\t},\n\t\tweekColor: {\n\t\t\ttype: String,\n\t\t\tdefault: '#BDC0C3'\n\t\t},\n\t\tweekFontSize: {\n\t\t\ttype: Number,\n\t\t\tdefault: 14\n\t\t},\n\t\tweekHeight: {\n\t\t\ttype: Number,\n\t\t\tdefault: 30\n\t\t},\n\t\tselectedDayBgColor: {\n\t\t\ttype: String,\n\t\t\tdefault: 'rgba(0,0,0,0.06)'\n\t\t},\n\t\tdayFontSize: {\n\t\t\ttype: Number,\n\t\t\tdefault: 16\n\t\t},\n\t\ttextColor: {\n\t\t\ttype: String,\n\t\t\tdefault: '#1A1F24'\n\t\t},\n\t\tdisabledColor: {\n\t\t\ttype: String,\n\t\t\tdefault: '#BDC0C3'\n\t\t},\n\t\tmonthTitleHeight: {\n\t\t\ttype: Number,\n\t\t\tdefault: 50\n\t\t},\n\t\tmonthTitleFontSize: {\n\t\t\ttype: Number,\n\t\t\tdefault: 20\n\t\t},\n\t\tcolor: {\n\t\t\ttype: String,\n\t\t\tdefault: '#3B87F6'\n\t\t},\n\t\tunsignedColor: {\n\t\t\ttype: String,\n\t\t\tdefault: '#F1A33A'\n\t\t},\n\t})\n\tlet drawRef = ref<UniCanvasElement|null>(null)\n\tlet calender:Calendar|null = null\n\t\n\t\n\tconst styles = computed(():Map<string, any> => {\n\t\tconst style = new Map<string, any>()\n\t\tstyle.set('height', `${6 * unitConvert(props.dayHeight) + props.weekHeight + props.monthTitleHeight}px`)\n\t\t\n\t\treturn style\n\t})\n\t\n\tconst onClick = (e: UniPointerEvent) => {\n\t\tcalender?.touch(e)\n\t}\n\t\n\tconst setOpt = () => {\n\t\tconst opt:LOptions = {\n\t\t\tcanSupplement: props.canSupplement,\n\t\t\tisFullCalendar: props.isFullCalendar,\n\t\t\tyearMonth: props.yearMonth,\n\t\t\tsignedDates: [...props.signedDates],\n\t\t\tdayHeight: unitConvert(props.dayHeight),\n\t\t\tweek: props.week as string[],\n\t\t\tweekStartsOn: props.weekStartsOn,\n\t\t\tweekColor: props.weekColor,\n\t\t\tweekFontSize: props.weekFontSize,\n\t\t\tweekHeight: props.weekHeight,\n\t\t\tselectedDayBgColor: props.selectedDayBgColor,\n\t\t\tdayFontSize: props.dayFontSize,\n\t\t\ttextColor: props.textColor,\n\t\t\tdisabledColor: props.disabledColor,\n\t\t\tmonthTitleHeight: props.monthTitleHeight,\n\t\t\tmonthTitleFontSize: props.monthTitleFontSize,\n\t\t\tcolor:props.color,\n\t\t\tunsignedColor: props.unsignedColor,\n\t\t\tselect: (e: LDay) => {\n\t\t\t\temits('select', e)\n\t\t\t},\n\t\t\tpanelChange: (e: LYearMonth) => {\n\t\t\t\temits('panelChange', e)\n\t\t\t}\n\t\t}\n\t\tif(calender == null) return\n\t\tcalender!.setOptions(opt)\n\t}\n\twatchEffect(() => {\n\t\tsetOpt()\n\t\tif(calender == null) return\n\t\tcalender!.render()\n\t\temits('streak', calender!.checkinDays)\n\t})\n\tconst instance = getCurrentInstance()!.proxy!\n\t\n\n\t// 异步调用方式, 跨平台写法\n\tuni.createCanvasContextAsync({\n\t\tid: 'l-daily-punch',\n\t\tcomponent: instance,\n\t\tsuccess: (context : CanvasContext) => {\n\t\t\tconst canvasContext = context.getContext('2d')!;\n\t\t\tconst canvas = canvasContext.canvas;\n\t\t\tcalender = new Calendar()\n\t\t\tsetOpt()\n\t\t\tcalender!.setCanvas(canvas)\n\t\t\tcalender!.render()\n\t\t\temits('streak', calender!.checkinDays)\n\t\t}\n\t})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n</script>\n<style lang=\"scss\">\n\t.l-daily-punch {\n\t\twidth: 100%;\n\t\t// height: 75 * 6 + 50px + 40px;\n\t}\n\t.calender{\n\t\tmargin:0 30rpx;\n\t}\n</style>","import Component from '/Users/xyhc/Documents/veepai_uniappx/uni_modules/lime-daily-punch/components/l-daily-punch/l-daily-punch.uvue'\nwx.createComponent(Component)"],"names":["ref","computed","unitConvert","watchEffect","getCurrentInstance","uni","Calendar","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUC,UAAM,QAAQ;AACd,UAAM,QAAQ;AA8FAA,kBAAAA,IAA2B,IAAI;AAC7C,QAAI,WAAyB;AAG7B,UAAM,SAASC,cAAAA,SAAS,MAAA;AACvB,YAAM,QAAQ,oBAAI;AAClB,YAAM,IAAI,UAAU,GAAG,IAAIC,yCAAW,YAAC,MAAM,SAAS,IAAI,MAAM,aAAa,MAAM,gBAAgB,IAAI;AAEvG,aAAO;AAAA,IACR,CAAC;AAED,UAAM,UAAU,CAAC,MAAkB;AAClC,mBAAQ,QAAR,aAAA,SAAA,OAAA,SAAU,MAAM,CAAC;AAAA,IAClB;AAEA,UAAM,SAAS,MAAA;AACd,YAAM,MAAe;AAAA,QACpB,eAAe,MAAM;AAAA,QACrB,gBAAgB,MAAM;AAAA,QACtB,WAAW,MAAM;AAAA,QACjB,aAAa,CAAC,GAAG,MAAM,WAAW;AAAA,QAClC,WAAWA,yCAAAA,YAAY,MAAM,SAAS;AAAA,QACtC,MAAM,MAAM;AAAA,QACZ,cAAc,MAAM;AAAA,QACpB,WAAW,MAAM;AAAA,QACjB,cAAc,MAAM;AAAA,QACpB,YAAY,MAAM;AAAA,QAClB,oBAAoB,MAAM;AAAA,QAC1B,aAAa,MAAM;AAAA,QACnB,WAAW,MAAM;AAAA,QACjB,eAAe,MAAM;AAAA,QACrB,kBAAkB,MAAM;AAAA,QACxB,oBAAoB,MAAM;AAAA,QAC1B,OAAM,MAAM;AAAA,QACZ,eAAe,MAAM;AAAA,QACrB,QAAQ,CAAC,MAAO;AACf,gBAAM,UAAU,CAAC;AAAA,QACjB;AAAA,QACD,aAAa,CAAC,MAAa;AAC1B,gBAAM,eAAe,CAAC;AAAA,QACvB;AAAA;AAED,UAAG,YAAY;AAAM,eAAM;AAC3B,eAAU,WAAW,GAAG;AAAA,IACzB;AACAC,kBAAAA,YAAY,MAAA;AACX;AACA,UAAG,YAAY;AAAM,eAAM;AAC3B,eAAU,OAAM;AAChB,YAAM,UAAU,SAAU,WAAW;AAAA,IACtC,CAAC;AACD,UAAM,WAAWC,iCAAqB,EAAC;AAIvCC,kBAAAA,MAAI,yBAAyB;AAAA,MAC5B,IAAI;AAAA,MACJ,WAAW;AAAA,MACX,SAAS,CAAC,YAAuB;AAChC,cAAM,gBAAgB,QAAQ,WAAW,IAAI;AAC7C,cAAM,SAAS,cAAc;AAC7B,mBAAW,IAAIC,2DAAAA;AACf;AACA,iBAAU,UAAU,MAAM;AAC1B,iBAAU,OAAM;AAChB,cAAM,UAAU,SAAU,WAAW;AAAA,MACtC;AAAA,IACA,CAAA;;;;;;;;;;;;AC3KF,GAAG,gBAAgBC,SAAS;"}