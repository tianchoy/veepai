{"version":3,"file":"l-icon.js","sources":["uni_modules/lime-icon/components/l-icon/l-icon.uvue","/Users/xyhc/Documents/veepai_uniappx/uni_modules/lime-icon/components/l-icon/l-icon.uvue?type=component"],"sourcesContent":["<template>\r\n\t<text class=\"l-icon\" :class=\"[classes, lClass]\" :style=\"[styles, lStyle]\" v-if=\"!isImage && !isIconify && !isSVG\" @click=\"$emit('click')\">{{iconCode}}</text>\r\n\t<image class=\"l-icon\" :class=\"[classes, lClass]\" :style=\"[styles, lStyle]\" v-else-if=\"(!isSVG && !isIconify) && isImage\" :src=\"iconUrl\" @click=\"$emit('click')\"></image>\r\n\t<!-- <l-svg class=\"l-icon\" :class=\"[classes, lClass]\" :style=\"[styles, lStyle]\" :color=\"color\" :src=\"iconUrl\" v-else :web=\"web\" @error=\"imageError\" @load=\"imageload\" @click=\"$emit('click')\"></l-svg> -->\r\n</template>\r\n<script lang=\"uts\" setup>\r\n\t/**\r\n\t * LimeIcon 图标\r\n\t * @description ICON集\r\n\t * <br> 插件类型：LIconComponentPublicInstance \r\n\t * @tutorial https://ext.dcloud.net.cn/plugin?id=14057\r\n\t * @property {String} name 图标名称\r\n\t * @property {String} color 颜色\r\n\t * @property {String} size 尺寸\r\n\t * @property {String} prefix 字体图标前缀  \r\n\t * @property {Boolean} inherit 是否继承颜色 \r\n\t * @property {Boolean} web 原生 app(nvue,uvue) 是否使用web渲染  \r\n\t * @event {Function} click 点击事件\r\n\t */\r\n\t\r\n\timport { addUnit } from '@/uni_modules/lime-shared/addUnit';\r\n\timport { IconCollection } from './types';\r\n\timport { icons } from './icons'\r\n\t// defineOptions({\r\n\t// \tname: 'l-icon'\r\n\t// })\r\n\tconst name = 'l-icon'\r\n\tconst IconifyURL : string = 'https://api.iconify.design/';\r\n\tconst $iconsHost : string | null = uni.getStorageSync('$limeIconsHost') as string | null\r\n\r\n\tconst props = defineProps({\r\n\t\tname: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '',\r\n\t\t\trequired: true,\r\n\t\t\t// validator: (value: string) : boolean => {\r\n\t\t\t// \t// 确保是字符串类型且不为空\r\n\t\t\t// \treturn typeof value == 'string' && value.trim().length > 0\r\n\t\t\t// }\r\n\t\t},\r\n\t\tcolor: {\r\n\t\t\ttype: String,\r\n\t\t\t// default: ''\r\n\t\t},\r\n\t\tsize: {\r\n\t\t\ttype: [String, Number],\r\n\r\n\r\n\r\n\t\t},\r\n\t\tprefix: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\tlClass: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\t// 对安卓IOS无效\r\n\t\tinherit: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t},\r\n\t\tweb: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\tlStyle: {\r\n\t\t\ttype: [String, Object, Array],\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t})\r\n\r\n\tconst emits = defineEmits(['click'])\r\n\tconst $iconCollection = inject<IconCollection>('$iconCollection', {has: false, icons: new Map<string, any|null>()} as IconCollection)\r\n\r\n\tconst innerName = computed(():string => props.name ?? '')\r\n\r\n\r\n\r\n\r\n\tconst collectionIcon = computed(():string|null => {\r\n\t\treturn $iconCollection.icons.get(innerName.value) as string | null\r\n\t})\r\n\tconst webviewRef = ref<UniWebViewElement | null>(null)\r\n\tconst hasHost = computed<boolean>(() : boolean => innerName.value.indexOf('/') != -1)\r\n\tconst isIconify = computed<boolean>(() : boolean => {\r\n\t\treturn !hasHost.value && innerName.value.includes(':')\r\n\t})\r\n\tconst isImage = computed<boolean>(() : boolean => {\r\n\t\treturn /\\.(jpe?g|png|gif|bmp|webp|tiff?)$/i.test(innerName.value) || /^data:image\\/(jpeg|png|gif|bmp|webp|tiff);base64,/.test(innerName.value)\r\n\t})\r\n\tconst isSVG = computed<boolean>(():boolean => {\r\n\t\treturn /\\.svg$/i.test(innerName.value) || innerName.value.startsWith('data:image/svg+xml') || innerName.value.startsWith('<svg')\r\n\t})\r\n\tconst classes = computed<Map<string, any>>(() : Map<string, any> => {\r\n\t\tconst cls = new Map<string, any>()\r\n\t\tcls.set(`${name}--font`, !isImage.value && !isIconify.value && !isSVG.value)\r\n\t\tcls.set(`${name}--image`, isImage.value || isIconify.value || isSVG.value)\r\n\t\tcls.set(props.prefix, props.prefix.length > 0)\r\n\t\tcls.set(props.lClass, props.lClass.length > 0)\r\n\r\n\t\tcls.set(`is-inherit`, (isIconify.value) && (props.color && props.color.length > 0 || props.inherit))\r\n\r\n\t\treturn cls\r\n\t})\r\n\tconst styles = computed<Map<string, any>>(() : Map<string, any> => {\r\n\t\tconst style = new Map<string, any>();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\tif(props.color) {\r\n\t\t\tstyle.set('color', props.color!)\r\n\t\t}\r\n\t\tconst size = addUnit(props.size)\r\n\r\n\t\tif (size != null) {\r\n\t\t\tif (isImage.value || isIconify.value || isSVG.value) {\r\n\t\t\t\tstyle.set('height', size)\r\n\t\t\t\tstyle.set('width', size)\r\n\t\t\t} else {\r\n\t\t\t\tstyle.set('font-size', size)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\treturn style\r\n\t})\r\n\tconst iconCode = computed<string>(() : string => {\r\n\t\treturn icons.value.get(innerName.value) as string | null ?? (/[^\\x00-\\x7F]/.test(innerName.value) ? innerName.value : '')\r\n\t})\r\n\tconst isError = ref(false)\r\n\tconst cacheMap = new Map<string, string>()\r\n\tconst iconUrl = computed(():string => {\r\n\t\tconst hasIconsHost = $iconsHost != null && $iconsHost != '' \r\n\t\t// const hasIconCollection = $iconCollection.has\r\n\t\tif(isImage.value) {\r\n\t\t\treturn hasHost.value ? innerName.value : ($iconsHost ?? '') + innerName.value\r\n\t\t} else if(isIconify.value) {\r\n\t\t\t// 防止重绘\r\n\t\t\tif(cacheMap.has(innerName.value) && !isError.value) {\r\n\t\t\t\treturn cacheMap.get(innerName.value)!\r\n\t\t\t}\r\n\t\t\t// 如果存在collectionIcon则使用 \r\n\t\t\t// 如果设置的路径加载失败 就使用网络地址 就使用iconify api\r\n\t\t\tconst _host = `${hasIconsHost ? $iconsHost : IconifyURL}`\r\n\t\t\tconst _icon =collectionIcon.value ?? _host + `${innerName.value}.svg`.replace(/:/g, '/') \r\n\t\t\tcacheMap.set(innerName.value, _icon)\r\n\t\t\treturn _icon\r\n\t\t} else if(isSVG.value) {\r\n\t\t\treturn (/\\.svg$/i.test(innerName.value) && $iconsHost != null && !hasHost.value ? $iconsHost : '') + innerName.value.replace(/'/g, '\"')\r\n\t\t} else {\r\n\t\t\treturn ''\r\n\t\t}\r\n\t})\r\n\t\t\r\n\tconst imageError = () => {\r\n\t\tisError.value = true\r\n\t}\r\n\tconst imageload = () => {\r\n\t\tisError.value = false\r\n\t}\r\n</script>\r\n<style lang=\"scss\">\r\n\t@import './index.scss';\r\n</style>","import Component from '/Users/xyhc/Documents/veepai_uniappx/uni_modules/lime-icon/components/l-icon/l-icon.uvue'\nwx.createComponent(Component)"],"names":["uni","inject","computed","_a","ref","addUnit","icons","Component"],"mappings":"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"}